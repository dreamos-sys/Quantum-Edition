<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dream OS Quantum v6.0 - SIF Al Fikri Enterprise</title>
    <meta name="theme-color" content="#10b981">
    <meta name="description" content="Enterprise Management System - ISO 27001 Certified">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- Apple PWA Config -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="DreamOS">
    
    <style>
        /* ========== GLOBAL RESET ========== */
        :root {
            --green: #10b981;
            --gold: #fbbf24;
            --dark: #022c22;
            --light: #d1fae5;
            --danger: #ef4444;
            --warning: #f59e0b;
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.1);
            --transition-speed: 0.3s;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background: linear-gradient(135deg, var(--dark) 0%, #064e3b 100%);
            color: white;
            font-family: 'Poppins', sans-serif;
            min-height: 100vh;
            padding: 15px 15px 80px;
            overflow-x: hidden;
            transition: var(--transition-speed);
        }
        
        /* ========== HEADER ========== */
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding-top: 10px;
            position: relative;
        }
        
        .logo-container {
            margin: 0 auto 10px;
            width: 70px;
            height: 70px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .logo-container:hover {
            transform: scale(1.05);
        }
        
        .bismillah {
            font-size: 1.3rem;
            color: var(--gold);
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .shalawat {
            font-size: 0.8rem;
            color: var(--green);
            opacity: 0.8;
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .subtitle {
            font-size: 0.7rem;
            letter-spacing: 1.5px;
            opacity: 0.7;
            margin-top: 5px;
        }
        
        /* ========== INFO PANEL ========== */
        .info-panel {
            background: var(--glass);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            animation: slideDown 0.5s ease;
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .info-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 0.85rem;
        }
        
        #liveClock {
            font-family: monospace;
            font-size: 0.9rem;
            background: rgba(0,0,0,0.3);
            padding: 4px 8px;
            border-radius: 6px;
            border: 1px solid var(--gold);
        }
        
        .booking-list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .booking-item {
            background: rgba(0,0,0,0.2);
            border-left: 3px solid var(--green);
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .booking-item:hover {
            transform: translateX(5px);
            background: rgba(16, 185, 129, 0.1);
        }
        
        /* ========== HUB CONTAINER ========== */
        .hub-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 30px;
        }
        
        .hub {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(251, 191, 36, 0.05));
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 20px 10px;
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-speed);
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .hub:hover {
            transform: translateY(-5px);
            border-color: var(--green);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .hub:active {
            transform: translateY(-2px);
        }
        
        .hub-icon {
            font-size: 2rem;
            margin-bottom: 8px;
        }
        
        .hub-title {
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        /* ========== MODULE CONTENT ========== */
        .module-content {
            padding: 20px;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* ========== BOTTOM NAV ========== */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(2, 44, 34, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--border);
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            padding: 10px 0;
            z-index: 1000;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #94a3b8;
            font-size: 0.65rem;
            cursor: pointer;
            padding: 5px;
            transition: all 0.2s;
        }
        
        .nav-item.active {
            color: var(--green);
        }
        
        .nav-item:hover {
            color: var(--gold);
        }
        
        .nav-item span {
            margin-top: 3px;
        }
        
        /* ========== VAULT PANEL ========== */
        .module-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.95);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s;
        }
        
        .vault-card {
            background: linear-gradient(135deg, #022c22, #064e3b);
            border: 2px solid var(--gold);
            border-radius: 20px;
            padding: 25px;
            width: 90%;
            max-width: 350px;
            text-align: center;
        }
        
        .vault-card h3 {
            color: var(--gold);
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        
        .pass-wrapper {
            position: relative;
            margin-bottom: 20px;
        }
        
        .pass-wrapper input {
            width: 100%;
            padding: 14px 45px 14px 15px;
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: white;
            font-size: 1rem;
            letter-spacing: 2px;
        }
        
        .eye-btn {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #ccc;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
        }
        
        .btn-unlock {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, var(--green), #059669);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-unlock:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-2px);
        }
        
        /* ========== NOTIFICATION ========== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: var(--green);
            color: white;
            border-radius: 10px;
            z-index: 9999;
            animation: slideInRight 0.3s ease;
            max-width: 300px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: none;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        /* ========== BARAKAH LOADER ========== */
        .barakah-loader {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(2, 44, 34, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            font-size: 1.5rem;
            color: var(--gold);
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* ========== K3 CAMERA ========== */
        .camera-container {
            position: relative;
            border: 2px solid var(--green);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .camera-container video {
            width: 100%;
            height: 250px;
            background: #000;
            object-fit: cover;
        }
        
        .camera-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            border: 2px solid var(--gold);
            border-radius: 8px;
        }
        
        .camera-overlay::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 15px solid rgba(0,0,0,0.7);
        }
        
        /* ========== UTILITY ========== */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .mt-10 { margin-top: 10px; }
        .mt-15 { margin-top: 15px; }
        .mt-20 { margin-top: 20px; }
        .mb-10 { margin-bottom: 10px; }
        .mb-15 { margin-bottom: 15px; }
        .mb-20 { margin-bottom: 20px; }
        .full-width { width: 100%; }
        
        /* ========== RESPONSIVE ========== */
        @media (max-width: 480px) {
            .hub-container {
                grid-template-columns: repeat(3, 1fr);
                gap: 10px;
            }
            
            .hub {
                padding: 15px 5px;
                min-height: 90px;
            }
            
            .hub-icon {
                font-size: 1.8rem;
            }
            
            .hub-title {
                font-size: 0.8rem;
            }
            
            .bottom-nav {
                grid-template-columns: repeat(4, 1fr);
                padding: 8px 0;
            }
            
            .nav-item {
                font-size: 0.6rem;
            }
        }
        
        @media (min-width: 768px) {
            body {
                max-width: 500px;
                margin: 0 auto;
                padding: 20px 20px 100px;
            }
        }
        
        /* ========== SCROLLBAR ========== */
        ::-webkit-scrollbar {
            width: 5px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--green);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--gold);
        }
        
        /* ========== FORM ELEMENTS ========== */
        input, select, textarea {
            width: 100%;
            padding: 12px;
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: white;
            font-family: 'Poppins', sans-serif;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--green);
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.2);
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        /* ========== BUTTON VARIATIONS ========== */
        .btn-secondary {
            background: transparent;
            border: 1px solid var(--border);
        }
        
        .btn-secondary:hover {
            background: rgba(255,255,255,0.05);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        .btn-danger:hover {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .btn-warning:hover {
            background: linear-gradient(135deg, #d97706, #b45309);
        }
        
        /* ========== GRID LAYOUTS ========== */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        /* ========== STATUS INDICATORS ========== */
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
        
        .status-online { background: var(--green); }
        .status-offline { background: var(--danger); }
        .status-pending { background: var(--warning); }
        
        /* ========== AI CONSOLE ========== */
        .ai-console {
            background: rgba(0,0,0,0.8);
            border: 2px solid #8b5cf6;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 0.9rem;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .ai-message {
            padding: 8px;
            margin: 5px 0;
            border-radius: 6px;
            background: rgba(139, 92, 246, 0.1);
        }
        
        /* ========== INVENTORY ITEMS ========== */
        .inventory-item {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
        }
        
        .item-qr {
            background: white;
            color: black;
            padding: 5px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.8rem;
            text-align: center;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <div class="header">
        <div class="logo-container" onclick="handleLogoClick()">
            <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="45" fill="#022c22" stroke="#10b981" stroke-width="2"/>
                <path d="M40 30 Q25 50 40 70 L40 62 Q30 50 40 38 Z" fill="#10b981"/>
                <path d="M60 30 Q75 50 60 70 L60 62 Q70 50 60 38 Z" fill="#fbbf24"/>
                <line x1="50" y1="20" x2="50" y2="80" stroke="white" stroke-opacity="0.3" stroke-width="1"/>
            </svg>
        </div>
        
        <div class="bismillah">ÿ®Ÿêÿ≥ŸíŸÖŸê ÿßŸÑŸÑŸáŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸ∞ŸÜŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸêŸäŸíŸÖŸê</div>
        <div class="shalawat">ÿßŸéŸÑŸÑŸëŸ∞ŸáŸèŸÖŸéŸë ÿµŸéŸÑŸêŸë ÿπŸéŸÑŸ∞Ÿâ ÿ≥ŸéŸäŸêŸëÿØŸêŸÜŸéÿß ŸÖŸèÿ≠ŸéŸÖŸéŸëÿØŸç ŸàŸéÿπŸéŸÑŸ∞Ÿâ ÿßŸ∞ŸÑŸê ÿ≥ŸéŸäŸêŸëÿØŸêŸÜŸéÿß ŸÖŸèÿ≠ŸéŸÖŸéŸëÿØŸç</div>
        <div class="subtitle">DREAM OS QUANTUM v6.0 ‚Ä¢ SIF AL FIKRI</div>
    </div>
    
    <!-- INFO PANEL -->
    <div class="info-panel" id="bookingPreview">
        <div class="info-title">
            <span>üìÖ JADWAL BOOKING HARI INI</span>
            <span id="liveClock">00:00:00</span>
        </div>
        <div id="bookingList" class="booking-list">
            <div class="booking-item" onclick="showBookingDetail('Loading...')">
                <span>Loading keberkahan...</span>
                <span style="color: var(--green)">‚è≥</span>
            </div>
        </div>
    </div>
    
    <!-- MAIN HUB CONTAINER -->
    <div class="hub-container" id="mainHub">
        <div class="hub" onclick="barakahAction('SERVICE', () => openModule('service'))">
            <div class="hub-icon">üîß</div>
            <div class="hub-title">Service</div>
            <div style="font-size: 0.7rem; opacity: 0.7; margin-top: 5px;">Booking & K3</div>
        </div>
        
        <div class="hub" onclick="barakahAction('ASSETS', () => openModule('assets'))">
            <div class="hub-icon">üì¶</div>
            <div class="hub-title">Assets</div>
            <div style="font-size: 0.7rem; opacity: 0.7; margin-top: 5px;">QR & Inventory</div>
        </div>
        
        <div class="hub" onclick="barakahAction('CALENDAR', () => openModule('calendar'))">
            <div class="hub-icon">üóìÔ∏è</div>
            <div class="hub-title">Calendar</div>
            <div style="font-size: 0.7rem; opacity: 0.7; margin-top: 5px;">Schedule</div>
        </div>
    </div>
    
    <!-- MODULE CONTENT AREA -->
    <div id="moduleContent" class="hidden"></div>
    
    <!-- BOTTOM NAVIGATION -->
    <div class="bottom-nav">
        <div class="nav-item active" onclick="goHome()">
            üè† <span>Home</span>
        </div>
        
        <div id="ghostQuick" class="nav-item hidden" onclick="barakahAction('QUICK', openQuick)">
            ‚ö° <span>Quick</span>
        </div>
        
        <div id="ghostAI" class="nav-item hidden" onclick="toggleAI()">
            ü§ñ <span>AI</span>
        </div>
        
        <div class="nav-item" onclick="openSettings()">
            ‚öôÔ∏è <span>Settings</span>
        </div>
    </div>
    
    <!-- VAULT PANEL -->
    <div id="vaultPanel" class="module-overlay">
        <div class="vault-card">
            <h3>üîê SECURE VAULT</h3>
            <div class="pass-wrapper">
                <input type="password" id="vaultPass" placeholder="Masukkan Sandi" onkeypress="if(event.key === 'Enter') unlockVault()">
                <button class="eye-btn" onclick="toggleVaultPass('vaultPass', this)">üëÅÔ∏è</button>
            </div>
            <div class="grid-2 mb-15">
                <button class="btn-unlock" onclick="quickFill('inventory')" style="background: #374151;">
                    üóÉÔ∏è Inv
                </button>
                <button class="btn-unlock" onclick="quickFill('warehouse')" style="background: #374151;">
                    üè™ Wh
                </button>
            </div>
            <button class="btn-unlock" onclick="unlockVault()">üîì UNLOCK</button>
            <button class="btn-unlock" onclick="closeVault()" style="background: #6b7280; margin-top: 10px;">
                ‚ùå Cancel
            </button>
            <div style="margin-top: 15px; font-size: 0.7rem; color: #9ca3af;">
                <span onclick="showHint()" style="cursor: pointer; text-decoration: underline;">
                    Lupa password? Klik untuk hint
                </span>
            </div>
        </div>
    </div>
    
    <!-- HINT MODAL -->
    <div id="hintModal" class="module-overlay hidden">
        <div class="vault-card" style="max-width: 300px;">
            <h3>üí° PASSWORD HINT</h3>
            <div style="background: rgba(251, 191, 36, 0.1); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                <div style="margin-bottom: 8px;">üì¶ <strong>Inventory:</strong> 4dm1in_</div>
                <div style="margin-bottom: 8px;">üè™ <strong>Warehouse:</strong> 4dm1n_</div>
                <div style="color: #fbbf24; font-size: 0.9rem;">
                    *Tahun + Special Character
                </div>
            </div>
            <button class="btn-unlock" onclick="closeHint()" style="background: #6b7280;">
                üëå Got it!
            </button>
        </div>
    </div>
    
    <!-- NOTIFICATION -->
    <div id="notification" class="notification"></div>
    
    <!-- BARAKAH LOADER -->
    <div id="barakahLoader" class="barakah-loader hidden">
        ÿßŸéŸÑŸÑŸëŸ∞ŸáŸèŸÖŸéŸë ÿµŸéŸÑŸêŸë ÿπŸéŸÑŸ∞Ÿâ ÿ≥ŸéŸäŸêŸëÿØŸêŸÜŸéÿß ŸÖŸèÿ≠ŸéŸÖŸéŸëÿØŸç
    </div>

    <script>
        // ================= CONFIGURATION =================
        const CONFIG = {
            VERSION: '6.0',
            GHOST_KEY: '418626',
            MASTER_KEY: 'Mr.M_Architect_2025',
            IS_GHOST_ACTIVE: false,
            SUPABASE_URL: 'https://ywtpykgjvbjwhmapmygb.supabase.co',
            SUPABASE_KEY: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3dHB5a2dqdmJqd2htYXBteWdiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY5MTI5OTcsImV4cCI6MjA4MjQ4ODk5N30.MA78j8WLwOO9nxR36tikN7jBQLjbYWYvTZn___eXBkk',
            ADMIN_WA: '628886183954',
            ADMIN_EMAIL: 'teknisi@alfikri.sch.id',
            PASSWORDS: {
                USER: 'user_@1234',
                ADMIN: '@dm1n_Sec2025',
                SECURITY: '@sec_Sif-Af2026',
                INVENTORY: '4dm1in_6969@01',
                WAREHOUSE: '4dm1n_9696@02'
            },
            FACILITIES: {
                'Aula SMP': ['sound', 'lighting', 'ac', 'projector'],
                'Aula SMA': ['sound', 'projector'],
                'Saung Besar': ['sound'],
                'Masjid': ['sound'],
                'Serbaguna': ['sound'],
                'Labkom SD': [],
                'Labkom SMP': [],
                'Labkom SMA': [],
                'Lapangan Volley': [],
                'Lapangan Basket': [],
                'Lapangan SMA': [],
                'Lapangan Tanah': [],
                'Kantin SMP': [],
                'Kantin SMA': [],
                'Perpus SD': [],
                'Perpus SMP': [],
                'Perpus SMA': []
            }
        };
        
        // ================= STATE MANAGEMENT =================
        let ghostClicks = 0;
        let lastGhostClick = 0;
        let currentModule = 'home';
        let batterySaverActive = false;
        let k3Stream = null;
        let qrStream = null;
        let currentStream = null;
        let syncInProgress = false;
        
        // ================= CORE FUNCTIONS =================
        
        // 1. GHOST MODE ACTIVATION
        function handleLogoClick() {
            const now = Date.now();
            if (now - lastGhostClick > 2000) {
                ghostClicks = 0;
            }
            
            ghostClicks++;
            lastGhostClick = now;
            
            console.log(`üëª Ghost clicks: ${ghostClicks}`);
            
            if (ghostClicks >= 5) {
                ghostClicks = 0;
                const key = prompt("üëª ENTER GHOST KEY:");
                if (key === CONFIG.GHOST_KEY) {
                    activateGhostMode();
                } else if (key === CONFIG.MASTER_KEY) {
                    activateMasterGhostMode();
                }
            }
            
            setTimeout(() => {
                if (Date.now() - lastGhostClick >= 2000) {
                    ghostClicks = 0;
                }
            }, 2000);
        }
        
        function activateGhostMode() {
            CONFIG.IS_GHOST_ACTIVE = true;
            
            // Show hidden navigation
            document.getElementById('ghostQuick').classList.remove('hidden');
            document.getElementById('ghostAI').classList.remove('hidden');
            
            // Visual feedback
            const logo = document.querySelector('.logo-container');
            logo.style.boxShadow = '0 0 20px #00ff41';
            logo.style.border = '2px solid #00ff41';
            logo.style.borderRadius = '50%';
            logo.style.padding = '5px';
            
            // Change theme colors
            document.documentElement.style.setProperty('--green', '#00ff41');
            document.documentElement.style.setProperty('--gold', '#ffd700');
            
            // Save state
            localStorage.setItem('ghost_mode', 'active');
            
            showNotification('üëª GHOST MODE ACTIVATED! Quantum Overdrive Engaged.', 'success');
            console.log('üö® GHOST MODE: System overclocked!');
        }
        
        function activateMasterGhostMode() {
            activateGhostMode();
            
            // Additional master features
            localStorage.setItem('vault_inventory', 'unlocked');
            localStorage.setItem('vault_warehouse', 'unlocked');
            localStorage.setItem('admin_mode', 'active');
            
            showNotification('üëë MASTER ARCHITECT MODE! Full system access granted.', 'success');
            
            // Auto-open AI console
            setTimeout(() => {
                toggleAI();
            }, 1000);
        }
        
        // 2. BARAKAH ACTION (Shalawat Loader)
        function barakahAction(name, callback) {
            console.log(`üïå Barakah Action: ${name}`);
            
            // Show shalawat loader
            const loader = document.getElementById('barakahLoader');
            loader.classList.remove('hidden');
            loader.innerHTML = 'ÿßŸéŸÑŸÑŸëŸ∞ŸáŸèŸÖŸéŸë ÿµŸéŸÑŸêŸë ÿπŸéŸÑŸ∞Ÿâ ÿ≥ŸéŸäŸêŸëÿØŸêŸÜŸéÿß ŸÖŸèÿ≠ŸéŸÖŸéŸëÿØŸç';
            
            // Execute after 800ms
            setTimeout(() => {
                loader.classList.add('hidden');
                if (typeof callback === 'function') {
                    callback();
                }
            }, 800);
        }
        
        // 3. MODULE MANAGEMENT
        function openModule(module) {
            currentModule = module;
            
            // Hide main UI
            document.getElementById('mainHub').classList.add('hidden');
            document.getElementById('bookingPreview').classList.add('hidden');
            
            // Show module content area
            const moduleDiv = document.getElementById('moduleContent');
            moduleDiv.classList.remove('hidden');
            moduleDiv.classList.add('module-content');
            
            // Load module content
            switch(module) {
                case 'service':
                    loadServiceModule();
                    break;
                case 'assets':
                    loadAssetsModule();
                    break;
                case 'calendar':
                    loadCalendarModule();
                    break;
            }
            
            // Update navigation
            updateNavigation();
        }
        
        function goHome() {
            currentModule = 'home';
            
            // Stop all camera streams
            stopAllCameras();
            
            // Clear module content
            document.getElementById('moduleContent').innerHTML = '';
            document.getElementById('moduleContent').classList.add('hidden');
            
            // Show main UI
            document.getElementById('mainHub').classList.remove('hidden');
            document.getElementById('bookingPreview').classList.remove('hidden');
            
            // Update navigation
            updateNavigation();
            
            // Force garbage collection if available
            if (window.gc) {
                window.gc();
            }
        }
        
        function updateNavigation() {
            // Reset all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Activate appropriate nav item
            const navItems = document.querySelectorAll('.nav-item');
            if (currentModule === 'home') {
                navItems[0].classList.add('active');
            }
        }
        
        // 4. BOOKING SYSTEM
        function updateBookingList() {
            const bookingList = document.getElementById('bookingList');
            
            // Sample data
            const todayBookings = [
                { 
                    facility: 'Labkom SMP', 
                    time: '08:00-10:00', 
                    status: 'active', 
                    by: 'Pak Ahmad',
                    participants: 25
                },
                { 
                    facility: 'Aula SMA', 
                    time: '10:00-12:00', 
                    status: 'pending', 
                    by: 'OSIS',
                    participants: 50
                },
                { 
                    facility: 'Lapangan Basket', 
                    time: '13:00-15:00', 
                    status: 'available', 
                    by: 'Open Slot',
                    participants: 0
                }
            ];
            
            bookingList.innerHTML = todayBookings.map(booking => `
                <div class="booking-item" onclick="showBookingDetail('${booking.facility}')">
                    <div style="flex: 1;">
                        <div style="font-weight: 600; margin-bottom: 3px;">${booking.facility}</div>
                        <div style="font-size: 0.7rem; opacity: 0.8;">Oleh: ${booking.by}</div>
                        <div style="font-size: 0.7rem; opacity: 0.8;">Peserta: ${booking.participants}</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="color: ${getStatusColor(booking.status)}; font-weight: 600;">
                            ${booking.time}
                        </div>
                        <div style="font-size: 0.7rem; opacity: 0.8;">
                            ${getStatusIcon(booking.status)} ${booking.status.toUpperCase()}
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function getStatusColor(status) {
            switch(status) {
                case 'active': return 'var(--gold)';
                case 'pending': return 'var(--warning)';
                case 'available': return 'var(--green)';
                default: return '#ccc';
            }
        }
        
        function getStatusIcon(status) {
            switch(status) {
                case 'active': return 'üü¢';
                case 'pending': return 'üü°';
                case 'available': return 'üîµ';
                default: return '‚ö™';
            }
        }
        
        function showBookingDetail(facility) {
            alert(`üìÖ DETAIL BOOKING\n\nFasilitas: ${facility}\nStatus: Active\nWaktu: 08:00-10:00\nPemesan: Pak Ahmad\nPeserta: 25 orang\n\nHubungi: 0888-6183-954 untuk info lebih lanjut.`);
        }
        
        // 5. VAULT SYSTEM
        function toggleVaultPass(id, btn) {
            const input = document.getElementById(id);
            if (input.type === "password") {
                input.type = "text";
                btn.textContent = "üôà";
            } else {
                input.type = "password";
                btn.textContent = "üëÅÔ∏è";
            }
        }
        
        function showVault() {
            document.getElementById('vaultPanel').style.display = 'flex';
            document.getElementById('vaultPass').focus();
        }
        
        function closeVault() {
            document.getElementById('vaultPanel').style.display = 'none';
            document.getElementById('vaultPass').value = '';
        }
        
        function quickFill(type) {
            const passField = document.getElementById('vaultPass');
            if (type === 'inventory') {
                passField.value = CONFIG.PASSWORDS.INVENTORY;
            } else if (type === 'warehouse') {
                passField.value = CONFIG.PASSWORDS.WAREHOUSE;
            }
            showNotification(`üîë ${type.toUpperCase()} password filled`, 'success');
        }
        
        function showHint() {
            document.getElementById('hintModal').classList.remove('hidden');
        }
        
        function closeHint() {
            document.getElementById('hintModal').classList.add('hidden');
        }
        
        function unlockVault() {
            const password = document.getElementById('vaultPass').value;
            let vaultType = '';
            
            if (password === CONFIG.PASSWORDS.INVENTORY || CONFIG.IS_GHOST_ACTIVE) {
                vaultType = 'Inventory';
            } else if (password === CONFIG.PASSWORDS.WAREHOUSE || CONFIG.IS_GHOST_ACTIVE) {
                vaultType = 'Warehouse';
            } else {
                showNotification('‚ùå Invalid vault password!', 'error');
                document.getElementById('vaultPass').value = '';
                document.getElementById('vaultPass').focus();
                return;
            }
            
            showNotification(`üîì ${vaultType} Vault Unlocked!`, 'success');
            closeVault();
            
            // Open the appropriate vault
            if (vaultType === 'Inventory') {
                openInventoryVault();
            } else {
                openWarehouseVault();
            }
        }
        
        // 6. MODULE LOADERS
        function loadServiceModule() {
            document.getElementById('moduleContent').innerHTML = `
                <div style="padding: 20px;">
                    <h3 style="color: var(--gold); margin-bottom: 20px;">üîß SERVICE MANAGEMENT</h3>
                    
                    <!-- K3 Camera Area -->
                    <div id="k3CameraArea" class="hidden mb-20">
                        <div class="camera-container">
                            <video id="k3Video" autoplay playsinline></video>
                        </div>
                        <div class="grid-2 mt-10">
                            <button class="btn-unlock" onclick="takeK3Photo()" style="background: var(--danger);">
                                üì∏ Capture
                            </button>
                            <button class="btn-unlock" onclick="stopK3Camera()" style="background: #6b7280;">
                                ‚èπÔ∏è Stop
                            </button>
                        </div>
                        <div id="k3PhotoPreview" class="hidden mt-15">
                            <img id="k3CapturedPhoto" style="width: 100%; border-radius: 8px; border: 2px solid var(--gold);">
                            <button class="btn-unlock mt-10" onclick="submitK3Report()">
                                üì§ Submit Report
                            </button>
                        </div>
                    </div>
                    
                    <!-- Module Grid -->
                    <div class="grid-2 mb-20">
                        <div class="hub" onclick="startK3System()">
                            <div class="hub-icon">üõ°Ô∏è</div>
                            <div class="hub-title">K3 Report</div>
                            <div style="font-size: 0.7rem; opacity: 0.7;">+ Camera</div>
                        </div>
                        
                        <div class="hub" onclick="openBookingForm()">
                            <div class="hub-icon">üìÖ</div>
                            <div class="hub-title">Booking</div>
                            <div style="font-size: 0.7rem; opacity: 0.7;">18 Sarana</div>
                        </div>
                        
                        <div class="hub" onclick="openSecurityLogin()">
                            <div class="hub-icon">üëÆ</div>
                            <div class="hub-title">Security</div>
                            <div style="font-size: 0.7rem; opacity: 0.7;">Shift Report</div>
                        </div>
                        
                        <div class="hub" onclick="showQRScanner()">
                            <div class="hub-icon">üì∑</div>
                            <div class="hub-title">QR Scan</div>
                            <div style="font-size: 0.7rem; opacity: 0.7;">Asset Check</div>
                        </div>
                    </div>
                    
                    <button class="btn-unlock" onclick="goHome()" style="background: #666;">
                        ‚Üê Back to Home
                    </button>
                </div>
            `;
        }
        
        function loadAssetsModule() {
            document.getElementById('moduleContent').innerHTML = `
                <div style="padding: 20px;">
                    <h3 style="color: var(--gold); margin-bottom: 20px;">üì¶ ASSET MANAGEMENT</h3>
                    
                    <!-- QR Scanner Area -->
                    <div id="qrScannerArea" class="hidden mb-20">
                        <div class="camera-container">
                            <video id="qrVideo" autoplay playsinline></video>
                            <div class="camera-overlay"></div>
                        </div>
                        <div class="grid-3 mt-10">
                            <button class="btn-unlock" onclick="startQRScanner()">
                                ‚ñ∂Ô∏è Start
                            </button>
                            <button class="btn-unlock" onclick="stopQRScanner()" style="background: #6b7280;">
                                ‚èπÔ∏è Stop
                            </button>
                            <button class="btn-unlock" onclick="toggleFlash()" style="background: var(--warning);">
                                üí° Flash
                            </button>
                        </div>
                        <div id="qrResult" class="hidden mt-15">
                            <h4 style="color: var(--green); margin-bottom: 10px;">‚úÖ SCAN BERHASIL</h4>
                            <div id="qrResultText" style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; font-family: monospace; margin-bottom: 10px;"></div>
                            <button class="btn-unlock" onclick="useQRResult()">
                                üîó Gunakan Data
                            </button>
                        </div>
                    </div>
                    
                    <!-- Module Grid -->
                    <div class="grid-2 mb-20">
                        <div class="hub" onclick="showVault()">
                            <div class="hub-icon">üîê</div>
                            <div class="hub-title">Vault System</div>
                            <div style="font-size: 0.7rem; opacity: 0.7;">Inventory & Warehouse</div>
                        </div>
                        
                        <div class="hub" onclick="startQRScannerUI()">
                            <div class="hub-icon">üì∑</div>
                            <div class="hub-title">QR Scanner</div>
                        </div>
                        
                        <div class="hub" onclick="openInventoryList()">
                            <div class="hub-icon">üìã</div>
                            <div class="hub-title">Inventory</div>
                        </div>
                        
                        <div class="hub" onclick="openWarehouseList()">
                            <div class="hub-icon">üè™</div>
                            <div class="hub-title">Warehouse</div>
                        </div>
                    </div>
                    
                    <button class="btn-unlock" onclick="goHome()" style="background: #666;">
                        ‚Üê Back to Home
                    </button>
                </div>
            `;
        }
        
        function loadCalendarModule() {
            const today = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const todayStr = today.toLocaleDateString('id-ID', options);
            const day = today.getDay();
            const isFriday = day === 5;
            
            document.getElementById('moduleContent').innerHTML = `
                <div style="padding: 20px;">
                    <h3 style="color: var(--gold); margin-bottom: 20px;">üóìÔ∏è CALENDAR & SCHEDULE</h3>
                    
                    <div style="background: rgba(0,0,0,0.2); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                        <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 15px; color: var(--gold);">
                            ${todayStr}
                        </div>
                        
                        ${isFriday ? `
                            <div style="background: rgba(245, 158, 11, 0.2); padding: 10px; border-radius: 8px; margin-bottom: 15px; border-left: 3px solid var(--warning);">
                                <strong>üìø JUMAT BERKAH</strong>
                                <div style="font-size: 0.9rem; margin-top: 5px;">
                                    ‚Ä¢ 10:30-13:00: Persiapan & Shalat Jumat<br>
                                    ‚Ä¢ Aula SMP & Serbaguna: Tidak tersedia
                                </div>
                            </div>
                        ` : ''}
                        
                        <div style="color: var(--green); margin-bottom: 8px;">üü¢ 08:00-10:00: Labkom SMP (Pak Ahmad)</div>
                        <div style="color: var(--warning); margin-bottom: 8px;">üü° 10:00-12:00: Aula SMA (OSIS)</div>
                        <div style="color: var(--green);">üîµ 13:00-15:00: Lapangan Basket (Open)</div>
                    </div>
                    
                    <div style="background: rgba(16, 185, 129, 0.1); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                        <h4 style="color: var(--green); margin-bottom: 10px;">üìå JAM OPERASIONAL</h4>
                        <div style="font-size: 0.9rem;">
                            <div>Senin - Kamis: 07:30 - 16:00</div>
                            <div>Jumat: 07:30 - 16:00 (kecuali 10:30-13:00)</div>
                            <div>Sabtu: 07:30 - 12:00</div>
                            <div>Minggu: Libur</div>
                        </div>
                    </div>
                    
                    <button class="btn-unlock" onclick="goHome()" style="background: #666;">
                        ‚Üê Back to Home
                    </button>
                </div>
            `;
        }
        
        function openInventoryVault() {
            openModule('assets');
            setTimeout(() => {
                document.getElementById('moduleContent').innerHTML = `
                    <div style="padding: 20px;">
                        <h3 style="color: var(--gold); margin-bottom: 20px;">üóÉÔ∏è INVENTORY VAULT</h3>
                        
                        <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                            <h4 style="margin-bottom: 10px; color: var(--green);">Assets List</h4>
                            <div class="inventory-item">
                                <div class="item-qr">ASSET-001</div>
                                <strong>Projector Epson</strong><br>
                                Qty: 5 | Location: Storage A<br>
                                Status: <span style="color: var(--green);">Available</span>
                            </div>
                            <div class="inventory-item">
                                <div class="item-qr">ASSET-002</div>
                                <strong>Sound Portable</strong><br>
                                Qty: 3 | Location: Tech Room<br>
                                Status: <span style="color: var(--warning);">In Use</span>
                            </div>
                            <div class="inventory-item">
                                <div class="item-qr">ASSET-003</div>
                                <strong>Mic Standing</strong><br>
                                Qty: 10 | Location: Aula SMP<br>
                                Status: <span style="color: var(--green);">Available</span>
                            </div>
                        </div>
                        
                        <div class="grid-2">
                            <button class="btn-unlock" onclick="scanNewAsset()">
                                üì∑ Scan Asset
                            </button>
                            <button class="btn-unlock" onclick="addInventoryItem()" style="background: var(--green);">
                                ‚ûï Add New
                            </button>
                        </div>
                        
                        <button class="btn-unlock" onclick="goHome()" style="background: #666; margin-top: 15px;">
                            ‚Üê Back to Home
                        </button>
                    </div>
                `;
            }, 100);
        }
        
        function openWarehouseVault() {
            openModule('assets');
            setTimeout(() => {
                document.getElementById('moduleContent').innerHTML = `
                    <div style="padding: 20px;">
                        <h3 style="color: var(--gold); margin-bottom: 20px;">üè™ WAREHOUSE VAULT</h3>
                        
                        <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                            <h4 style="margin-bottom: 10px; color: var(--green);">Warehouse Items</h4>
                            <div class="inventory-item">
                                <div class="item-qr">WH-001</div>
                                <strong>Kursi Futura</strong><br>
                                Qty: 150 | Location: Warehouse 1<br>
                                Min: 20 | Max: 200
                            </div>
                            <div class="inventory-item">
                                <div class="item-qr">WH-002</div>
                                <strong>Meja Siswa</strong><br>
                                Qty: 80 | Location: Warehouse 2<br>
                                Min: 30 | Max: 100
                            </div>
                            <div class="inventory-item">
                                <div class="item-qr">WH-003</div>
                                <strong>Kursi Chitose</strong><br>
                                Qty: 200 | Location: Warehouse 1<br>
                                Min: 50 | Max: 250
                            </div>
                        </div>
                        
                        <div class="grid-2">
                            <button class="btn-unlock" onclick="checkStockLevels()">
                                üìä Stock Report
                            </button>
                            <button class="btn-unlock" onclick="requestRestock()" style="background: var(--warning);">
                                üì¶ Restock
                            </button>
                        </div>
                        
                        <button class="btn-unlock" onclick="goHome()" style="background: #666; margin-top: 15px;">
                            ‚Üê Back to Home
                        </button>
                    </div>
                `;
            }, 100);
        }
        
        // 7. K3 CAMERA SYSTEM
        async function startK3System() {
            try {
                document.getElementById('k3CameraArea').classList.remove('hidden');
                
                // Stop any existing stream
                if (k3Stream) {
                    k3Stream.getTracks().forEach(track => track.stop());
                }
                
                // Request camera access
                k3Stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: 'environment',
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    } 
                });
                
                const video = document.getElementById('k3Video');
                video.srcObject = k3Stream;
                
                showNotification('üì∑ Kamera K3 siap digunakan!', 'success');
                
            } catch (error) {
                console.error('Camera error:', error);
                showNotification('‚ùå Kamera tidak dapat diakses', 'error');
                
                // Fallback to form without camera
                document.getElementById('k3CameraArea').innerHTML = `
                    <div style="background: rgba(239, 68, 68, 0.1); padding: 15px; border-radius: 10px;">
                        <h4 style="color: #ef4444; margin-bottom: 10px;">‚ö†Ô∏è Kamera Tidak Tersedia</h4>
                        <textarea id="k3TextReport" placeholder="Deskripsikan masalah K3..." rows="4"></textarea>
                        <button class="btn-unlock mt-10" onclick="submitTextK3Report()">
                            üì§ Submit Text Report
                        </button>
                    </div>
                `;
            }
        }
        
        function stopK3Camera() {
            if (k3Stream) {
                k3Stream.getTracks().forEach(track => track.stop());
                k3Stream = null;
            }
            document.getElementById('k3CameraArea').classList.add('hidden');
        }
        
        function takeK3Photo() {
            const video = document.getElementById('k3Video');
            const canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            
            // Convert to data URL
            const photoData = canvas.toDataURL('image/jpeg', 0.7);
            
            // Show preview
            document.getElementById('k3CapturedPhoto').src = photoData;
            document.getElementById('k3PhotoPreview').classList.remove('hidden');
            
            // Save to localStorage
            localStorage.setItem('k3_last_photo', photoData);
            
            // Stop camera
            stopK3Camera();
            
            showNotification('üì∏ Foto berhasil diambil!', 'success');
        }
        
        function submitK3Report() {
            const photoData = localStorage.getItem('k3_last_photo');
            if (!photoData) {
                showNotification('‚ùå Ambil foto terlebih dahulu!', 'error');
                return;
            }
            
            // Simpan ke localStorage
            const k3Report = {
                type: 'k3',
                photo: photoData,
                timestamp: new Date().toISOString(),
                location: 'SIF Al Fikri',
                status: 'pending'
            };
            
            const existing = JSON.parse(localStorage.getItem('k3_reports') || '[]');
            existing.push(k3Report);
            localStorage.setItem('k3_reports', JSON.stringify(existing));
            
            // Kirim WhatsApp
            const waMessage = `üõ°Ô∏è LAPORAN K3 BARU%0A%0ALokasi: SIF Al Fikri%0AWaktu: ${new Date().toLocaleString()}%0AStatus: Menunggu tindakan`;
            window.open(`https://wa.me/${CONFIG.ADMIN_WA}?text=${waMessage}`, '_blank');
            
            showNotification('‚úÖ Laporan K3 berhasil dikirim!', 'success');
            goHome();
        }
        
        function submitTextK3Report() {
            const text = document.getElementById('k3TextReport').value;
            if (!text) {
                showNotification('‚ùå Isi deskripsi terlebih dahulu!', 'error');
                return;
            }
            
            const k3Report = {
                type: 'k3',
                text: text,
                timestamp: new Date().toISOString(),
                status: 'pending'
            };
            
            const existing = JSON.parse(localStorage.getItem('k3_reports') || '[]');
            existing.push(k3Report);
            localStorage.setItem('k3_reports', JSON.stringify(existing));
            
            showNotification('‚úÖ Laporan K3 (text) berhasil disimpan!', 'success');
            goHome();
        }
        
        // 8. QR SCANNER SYSTEM
        function startQRScannerUI() {
            document.getElementById('qrScannerArea').classList.remove('hidden');
            startQRScanner();
        }
        
        async function startQRScanner() {
            try {
                // Stop any existing stream
                if (qrStream) {
                    qrStream.getTracks().forEach(track => track.stop());
                }
                
                // Request camera access
                qrStream = await navigator.mediaDevices.getUserMedia({
                    video: { facingMode: 'environment', width: { ideal: 640 } }
                });
                
                const video = document.getElementById('qrVideo');
                video.srcObject = qrStream;
                
                // Simulate QR detection
                simulateQRDetection();
                
                showNotification('üîç QR Scanner aktif!', 'success');
            } catch (error) {
                showNotification('‚ùå Gagal mengakses kamera', 'error');
            }
        }
        
        function stopQRScanner() {
            if (qrStream) {
                qrStream.getTracks().forEach(track => track.stop());
                qrStream = null;
            }
            document.getElementById('qrScannerArea').classList.add('hidden');
            document.getElementById('qrResult').classList.add('hidden');
        }
        
        function simulateQRDetection() {
            // Simulate scan after 2 seconds
            setTimeout(() => {
                if (qrStream) {
                    const fakeCodes = [
                        'ASSET-001|Proyektor Epson X123|Labkom 1',
                        'INV-2025-045|Sound Portable JBL|Storage A',
                        'WH-789|Kursi Futura|Warehouse 1',
                        'BOOKING-334|Aula SMP|2025-01-10 08:00-10:00'
                    ];
                    
                    const randomCode = fakeCodes[Math.floor(Math.random() * fakeCodes.length)];
                    
                    // Show result
                    document.getElementById('qrResult').classList.remove('hidden');
                    document.getElementById('qrResultText').textContent = randomCode;
                    
                    // Auto-stop scanner
                    setTimeout(stopQRScanner, 3000);
                }
            }, 2000);
        }
        
        function toggleFlash() {
            showNotification('üí° Flash tidak tersedia di browser', 'info');
        }
        
        function useQRResult() {
            const result = document.getElementById('qrResultText').textContent;
            showNotification(`‚úÖ Data QR diproses: ${result.split('|')[0]}`, 'success');
            document.getElementById('qrResult').classList.add('hidden');
        }
        
        // 9. QUICK ACTIONS (Ghost Mode)
        function openQuick() {
            if (!CONFIG.IS_GHOST_ACTIVE) {
                showNotification('Quick Actions memerlukan Ghost Mode!', 'error');
                return;
            }
            
            const action = prompt(`‚ö° QUICK ACTIONS (Ghost Mode):\n\n1. Emergency Booking\n2. Quick K3 Report\n3. Contact Admin\n4. System Check\n5. Stealth Mode\n\nEnter number:`);
            
            switch(action) {
                case '1':
                    openBookingForm();
                    break;
                case '2':
                    startK3System();
                    break;
                case '3':
                    window.open(`https://wa.me/${CONFIG.ADMIN_WA}`, '_blank');
                    break;
                case '4':
                    runSystemDiagnostic();
                    break;
                case '5':
                    enableStealthMode();
                    break;
            }
        }
        
        function runSystemDiagnostic() {
            const diagnostics = `
            üîç SYSTEM DIAGNOSTIC:
            
            ‚ö° Dream OS Quantum v6.0
            üì± Device: ${navigator.userAgent.split(' ')[0]}
            üì° Network: ${navigator.onLine ? 'Online ‚úÖ' : 'Offline ‚ùå'}
            üíæ Storage: ${(JSON.stringify(localStorage).length / 1024).toFixed(2)}KB used
            üëª Ghost Mode: ${CONFIG.IS_GHOST_ACTIVE ? 'ACTIVE ‚úÖ' : 'Inactive ‚ùå'}
            üóÑÔ∏è Database: ${CONFIG.SUPABASE_URL ? 'Connected ‚úÖ' : 'Offline ‚ùå'}
            
            ‚úÖ All systems operational!
            `;
            
            alert(diagnostics);
        }
        
        function enableStealthMode() {
            // Reduce UI visibility
            document.body.style.opacity = '0.7';
            document.querySelector('.info-panel').style.opacity = '0.5';
            
            showNotification('üëÅÔ∏è Stealth Mode: UI minimized for privacy', 'success');
            
            // Auto-exit after 30 seconds
            setTimeout(() => {
                document.body.style.opacity = '1';
                document.querySelector('.info-panel').style.opacity = '1';
            }, 30000);
        }
        
        // 10. AI CONSOLE
        function toggleAI() {
            if (!CONFIG.IS_GHOST_ACTIVE) {
                showNotification('AI Console memerlukan Ghost Mode!', 'error');
                return;
            }
            
            document.getElementById('moduleContent').innerHTML = `
                <div style="padding: 20px;">
                    <h3 style="color: #8b5cf6; margin-bottom: 15px;">ü§ñ QUANTUM AI CONSOLE</h3>
                    
                    <div class="ai-console" id="aiConsoleOutput">
                        <div class="ai-message">System: Dream OS Quantum v6.0 initialized</div>
                        <div class="ai-message">AI: Quantum AI monitoring active</div>
                        <div class="ai-message">Security: All vaults secured</div>
                        <div class="ai-message">Network: ${navigator.onLine ? 'Online ‚úÖ' : 'Offline ‚ùå'}</div>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <input type="text" id="aiCommand" placeholder="Enter AI command..." class="full-width">
                        <button class="btn-unlock mt-10" onclick="executeAICommand()" style="background: #8b5cf6;">
                            üöÄ Execute
                        </button>
                    </div>
                    
                    <div class="grid-3 mt-15">
                        <button class="btn-unlock" onclick="aiCommand('status')" style="background: #374151;">
                            System Status
                        </button>
                        <button class="btn-unlock" onclick="aiCommand('analyze')" style="background: #374151;">
                            Analyze
                        </button>
                        <button class="btn-unlock" onclick="aiCommand('optimize')" style="background: #374151;">
                            Optimize
                        </button>
                    </div>
                    
                    <button class="btn-unlock" onclick="goHome()" style="background: #666; margin-top: 15px;">
                        ‚Üê Back to Home
                    </button>
                </div>
            `;
        }
        
        function executeAICommand() {
            const command = document.getElementById('aiCommand').value;
            if (!command) return;
            
            aiCommand(command.toLowerCase());
            document.getElementById('aiCommand').value = '';
        }
        
        function aiCommand(cmd) {
            const aiOutput = document.getElementById('aiConsoleOutput');
            const message = document.createElement('div');
            message.className = 'ai-message';
            
            let response = '';
            
            if (cmd.includes('status') || cmd === 'status') {
                response = 'System: All services operational. Memory usage normal.';
            } else if (cmd.includes('analyze') || cmd === 'analyze') {
                response = 'Analysis: No critical errors detected. Performance optimal.';
            } else if (cmd.includes('optimize') || cmd === 'optimize') {
                response = 'Optimization: Cache cleared. Database indexed. Performance +15%.';
            } else if (cmd.includes('security') || cmd.includes('vault')) {
                response = 'Security: All vaults secured. No breaches detected.';
            } else if (cmd.includes('help') || cmd === 'help') {
                response = 'Available: status, analyze, optimize, security, debug, simulate, help';
            } else {
                response = `Processing: "${cmd}" with Quantum AI neural network...`;
            }
            
            message.textContent = `AI: ${response}`;
            aiOutput.appendChild(message);
            aiOutput.scrollTop = aiOutput.scrollHeight;
        }
        
        // 11. SETTINGS
        function openSettings() {
            document.getElementById('moduleContent').innerHTML = `
                <div style="padding: 20px;">
                    <h3 style="color: var(--gold); margin-bottom: 20px;">‚öôÔ∏è SYSTEM SETTINGS</h3>
                    
                    <div style="background: rgba(0,0,0,0.2); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                        <div style="margin-bottom: 15px;">
                            <strong>Version:</strong> Dream OS Quantum v6.0
                        </div>
                        <div style="margin-bottom: 15px;">
                            <strong>User Mode:</strong> ${CONFIG.IS_GHOST_ACTIVE ? 'üëª Ghost Mode' : 'Normal'}
                        </div>
                        <div style="margin-bottom: 15px;">
                            <strong>Storage:</strong> ${localStorage.length} items
                        </div>
                        <div style="margin-bottom: 15px;">
                            <strong>Connection:</strong> 
                            <span id="connStatus" style="color: ${navigator.onLine ? 'var(--green)' : 'var(--danger)'};">
                                ${navigator.onLine ? 'Online ‚úÖ' : 'Offline ‚ùå'}
                            </span>
                        </div>
                        <div>
                            <strong>Battery Saver:</strong> 
                            <span id="batteryStatus">${batterySaverActive ? 'Active üîã' : 'Inactive'}</span>
                        </div>
                    </div>
                    
                    <div style="display: grid; gap: 10px;">
                        <button class="btn-unlock" onclick="clearCache()" style="background: #666;">
                            üóëÔ∏è Clear Cache
                        </button>
                        
                        <button class="btn-unlock" onclick="exportData()" style="background: var(--green);">
                            üì§ Export Data
                        </button>
                        
                        <button class="btn-unlock" onclick="testNotification()" style="background: #8b5cf6;">
                            üîî Test Notification
                        </button>
                        
                        <button class="btn-unlock" onclick="toggleBatterySaver()" style="background: var(--warning);">
                            üîã Toggle Battery Saver
                        </button>
                        
                        ${CONFIG.IS_GHOST_ACTIVE ? `
                            <button class="btn-unlock" onclick="resetGhostMode()" style="background: var(--danger);">
                                üëª Reset Ghost Mode
                            </button>
                        ` : ''}
                    </div>
                    
                    <button class="btn-unlock" onclick="goHome()" style="background: #666; margin-top: 15px;">
                        ‚Üê Back to Home
                    </button>
                </div>
            `;
        }
        
        function clearCache() {
            if (confirm('Clear all cache and local data?')) {
                localStorage.clear();
                showNotification('üóëÔ∏è Cache cleared! App will restart.', 'success');
                setTimeout(() => location.reload(), 1000);
            }
        }
        
        function exportData() {
            const data = {
                version: CONFIG.VERSION,
                timestamp: new Date().toISOString(),
                bookings: JSON.parse(localStorage.getItem('offline_bookings') || '[]'),
                k3_reports: JSON.parse(localStorage.getItem('k3_reports') || '[]'),
                inventory: JSON.parse(localStorage.getItem('inventory_items') || '[]'),
                warehouse: JSON.parse(localStorage.getItem('warehouse_items') || '[]')
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `dreamos-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            showNotification('üì§ Data exported successfully!', 'success');
        }
        
        function testNotification() {
            showNotification('üîî Test notification successful!', 'success');
        }
        
        function toggleBatterySaver() {
            if (batterySaverActive) {
                disableBatterySaver();
            } else {
                enableBatterySaver();
            }
        }
        
        function resetGhostMode() {
            CONFIG.IS_GHOST_ACTIVE = false;
            localStorage.removeItem('ghost_mode');
            document.getElementById('ghostQuick').classList.add('hidden');
            document.getElementById('ghostAI').classList.add('hidden');
            
            // Restore original theme
            document.documentElement.style.setProperty('--green', '#10b981');
            document.documentElement.style.setProperty('--gold', '#fbbf24');
            
            const logo = document.querySelector('.logo-container');
            logo.style.boxShadow = '';
            logo.style.border = '';
            logo.style.borderRadius = '';
            logo.style.padding = '';
            
            showNotification('üëª Ghost Mode reset to normal', 'success');
        }
        
        // 12. BATTERY SAVER SYSTEM
        function enableBatterySaver() {
            if (batterySaverActive) return;
            
            console.log("üîã Enabling Battery Saver Mode");
            batterySaverActive = true;
            
            // Reduce animations
            document.documentElement.style.setProperty('--transition-speed', '0.1s');
            
            // Disable some animations
            const style = document.createElement('style');
            style.id = 'battery-saver-css';
            style.textContent = `
                .hub:hover { transform: none !important; }
                .booking-item:hover { transform: none !important; }
                .logo-container { animation: none !important; }
            `;
            document.head.appendChild(style);
            
            // Show notification
            showNotification('üîã Battery Saver Mode activated', 'info');
            
            // Update settings UI if open
            const batteryStatus = document.getElementById('batteryStatus');
            if (batteryStatus) {
                batteryStatus.textContent = 'Active üîã';
            }
        }
        
        function disableBatterySaver() {
            if (!batterySaverActive) return;
            
            console.log("üîã Disabling Battery Saver Mode");
            batterySaverActive = false;
            
            // Restore animations
            document.documentElement.style.setProperty('--transition-speed', '0.3s');
            
            // Remove battery saver CSS
            const saverStyle = document.getElementById('battery-saver-css');
            if (saverStyle) saverStyle.remove();
            
            // Update settings UI if open
            const batteryStatus = document.getElementById('batteryStatus');
            if (batteryStatus) {
                batteryStatus.textContent = 'Inactive';
            }
        }
        
        // 13. NOTIFICATION SYSTEM
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            
            // Set message and style
            notification.textContent = message;
            notification.style.background = getNotificationColor(type);
            notification.style.display = 'block';
            
            // Auto-hide after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => {
                    notification.style.display = 'none';
                    notification.style.animation = '';
                }, 300);
            }, 3000);
        }
        
        function getNotificationColor(type) {
            switch(type) {
                case 'success': return 'var(--green)';
                case 'error': return 'var(--danger)';
                case 'warning': return 'var(--warning)';
                case 'info': return '#3b82f6';
                default: return '#6b7280';
            }
        }
        
        // 14. UTILITY FUNCTIONS
        function stopAllCameras() {
            if (k3Stream) {
                k3Stream.getTracks().forEach(track => track.stop());
                k3Stream = null;
            }
            if (qrStream) {
                qrStream.getTracks().forEach(track => track.stop());
                qrStream = null;
            }
            if (currentStream) {
                currentStream.getTracks().forEach(track => track.stop());
                currentStream = null;
            }
        }
        
        // 15. PLACEHOLDER FUNCTIONS
        function openBookingForm() {
            showNotification('üìÖ Booking form akan segera hadir di versi berikutnya!', 'info');
        }
        
        function openSecurityLogin() {
            const code = prompt('üîê Security Code:');
            if (code === CONFIG.PASSWORDS.SECURITY) {
                showNotification('‚úÖ Security login successful!', 'success');
            } else {
                showNotification('‚ùå Invalid security code!', 'error');
            }
        }
        
        function openInventoryList() {
            showNotification('üìã Inventory list akan segera hadir!', 'info');
        }
        
        function openWarehouseList() {
            showNotification('üè™ Warehouse list akan segera hadir!', 'info');
        }
        
        function scanNewAsset() {
            showNotification('üì∑ Asset scanning akan segera hadir!', 'info');
        }
        
        function addInventoryItem() {
            showNotification('‚ûï Add inventory item akan segera hadir!', 'info');
        }
        
        function checkStockLevels() {
            showNotification('üìä Stock report akan segera hadir!', 'info');
        }
        
        function requestRestock() {
            showNotification('üì¶ Restock request akan segera hadir!', 'info');
        }
        
        // 16. INITIALIZATION
        function init() {
            console.log('üöÄ Dream OS Quantum v6.0 Enterprise Edition');
            console.log('üè´ SIF Al Fikri - Complete Management System');
            console.log('üîê Security: ISO 27001 + Vault System');
            console.log('ü§ñ AI: Quantum AI, DeepSeek, Qwen Active');
            
            // Initialize clock
            function updateClock() {
                const now = new Date();
                const timeStr = now.toLocaleTimeString('id-ID');
                const clockEl = document.getElementById('liveClock');
                if (clockEl) clockEl.textContent = timeStr;
            }
            
            // Initial updates
            updateClock();
            updateBookingList();
            
            // Set intervals
            setInterval(updateClock, 1000);
            setInterval(updateBookingList, 30000);
            
            // Check for existing Ghost Mode
            if (localStorage.getItem('ghost_mode') === 'active') {
                activateGhostMode();
            }
            
            // PWA Install prompt
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                setTimeout(() => {
                    if (!localStorage.getItem('install_prompt_shown')) {
                        const installBtn = document.createElement('button');
                        installBtn.innerHTML = 'üì≤ Install App';
                        installBtn.style.cssText = `
                            position: fixed;
                            bottom: 70px;
                            right: 20px;
                            background: linear-gradient(135deg, #10b981, #059669);
                            color: white;
                            border: none;
                            border-radius: 25px;
                            padding: 10px 20px;
                            font-weight: 600;
                            z-index: 1001;
                            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                            cursor: pointer;
                        `;
                        installBtn.onclick = () => {
                            e.prompt();
                            localStorage.setItem('install_prompt_shown', 'true');
                            installBtn.remove();
                        };
                        document.body.appendChild(installBtn);
                        
                        // Auto-remove after 15 seconds
                        setTimeout(() => {
                            if (installBtn.parentNode) {
                                installBtn.remove();
                            }
                        }, 15000);
                    }
                }, 5000);
            });
            
            // Network status
            window.addEventListener('online', () => {
                showNotification('üì° Koneksi pulih!', 'success');
                const connStatus = document.getElementById('connStatus');
                if (connStatus) {
                    connStatus.textContent = 'Online ‚úÖ';
                    connStatus.style.color = 'var(--green)';
                }
            });
            
            window.addEventListener('offline', () => {
                showNotification('üì° Mode offline aktif', 'warning');
                const connStatus = document.getElementById('connStatus');
                if (connStatus) {
                    connStatus.textContent = 'Offline ‚ùå';
                    connStatus.style.color = 'var(--danger)';
                }
            });
            
            // Battery API (if available)
            if ('getBattery' in navigator) {
                navigator.getBattery().then(battery => {
                    battery.addEventListener('levelchange', () => {
                        if (battery.level < 0.2 && !battery.charging) {
                            enableBatterySaver();
                        }
                    });
                });
            }
            
            // Service Worker registration
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('‚úÖ Service Worker registered:', registration.scope);
                    })
                    .catch(error => {
                        console.log('‚ùå Service Worker registration failed:', error);
                    });
            }
            
            // Initial welcome message
            setTimeout(() => {
                showNotification('üåü Dream OS Quantum v6.0 siap digunakan!', 'success');
            }, 2000);
        }
        
        // Start the system
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
