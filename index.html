<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>DREAM OS v6.0.6 - SIF AL FIKRI</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --gold: #FFD700; --light-green: #00FF88; --dark-bg: #0a0e14;
            --glass: rgba(255, 255, 255, 0.05); --border: rgba(255, 215, 0, 0.3);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: var(--dark-bg); color: white; font-family: 'Rajdhani', sans-serif; min-height: 100vh; overflow-x: hidden; }

        /* RUNNING TEXT SHALAWAT (HEADER) - dari versi spiritual */
        .shalawat-bar {
            background: rgba(255, 215, 0, 0.1);
            color: var(--gold);
            padding: 8px 0;
            font-size: 0.85rem;
            border-bottom: 1px solid var(--border);
            overflow: hidden;
            white-space: nowrap;
        }
        .marquee {
            display: inline-block;
            animation: marquee 25s linear infinite;
            padding-left: 100%;
        }
        @keyframes marquee {
            0% { transform: translate(0, 0); }
            100% { transform: translate(-100%, 0); }
        }

        .quantum-container { max-width: 500px; margin: 0 auto; padding: 15px; }

        /* ICON DREAM OS (CYBER STYLE) - dari versi spiritual */
        .icon-wrapper {
            width: 80px; height: 80px; margin: 10px auto;
            border: 2px solid var(--gold); border-radius: 20px;
            display: flex; align-items: center; justify-content: center;
            background: linear-gradient(45deg, #000, #1a1a1a);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3); position: relative;
        }
        .icon-wrapper i { color: var(--gold); font-size: 2.5rem; text-shadow: 0 0 10px var(--gold); }
        .icon-badge {
            position: absolute; bottom: -5px; right: -5px;
            background: var(--light-green); color: black;
            font-size: 0.6rem; padding: 2px 6px; border-radius: 5px; font-weight: bold;
        }

        .header { text-align: center; padding: 10px 0 20px; border-bottom: 1px solid var(--border); }
        .header h1 { font-family: 'Orbitron'; color: var(--gold); letter-spacing: 3px; font-size: 1.6rem; margin-top: 10px; }
        
        /* GRID 4 CARD - dari versi lengkap */
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 25px; }
        .menu-card { 
            background: var(--glass); border: 1px solid var(--border); 
            border-radius: 15px; padding: 25px 15px; text-align: center; transition: 0.2s;
        }
        .menu-card:active { transform: scale(0.95); background: rgba(255, 215, 0, 0.1); }
        .menu-card span { display: block; margin-top: 10px; font-weight: bold; font-size: 0.9rem; }

        .form-container { display: none; background: #111; border: 1px solid var(--gold); border-radius: 20px; padding: 20px; margin-top: 20px; }
        .input-field { width: 100%; padding: 12px; margin: 8px 0; background: #222; border: 1px solid var(--border); color: white; border-radius: 8px; font-family: 'Rajdhani'; font-size: 1rem; }
        .input-field:focus { outline: none; border-color: var(--gold); }
        .btn-submit { width: 100%; padding: 15px; background: var(--light-green); color: black; font-weight: bold; border: none; border-radius: 10px; cursor: pointer; font-family: 'Orbitron'; margin-top: 10px; transition: all 0.2s; }
        .btn-submit:active { transform: scale(0.98); }
        .btn-secondary { background: #444 !important; color: white !important; }
        
        #cameraContainer { position: relative; width: 100%; height: 250px; background: #000; border-radius: 15px; overflow: hidden; margin-bottom: 15px; display: none; border: 1px solid var(--light-green); }
        #cameraPreview { width: 100%; height: 100%; object-fit: cover; }
        
        .asset-list { margin-top: 10px; max-height: 200px; overflow-y: auto; background: rgba(255,255,255,0.02); border-radius: 10px; padding: 10px; }
        .asset-item { padding: 10px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; font-size: 0.9rem; }

        .notification { 
          position: fixed; top: 20px; left: 50%; transform: translateX(-50%); 
          background: rgba(0,30,0,0.9); border: 1px solid var(--gold); 
          padding: 12px 20px; border-radius: 25px; z-index: 9999; 
          display: none; min-width: 85%; text-align: center; 
          box-shadow: 0 5px 20px rgba(0,0,0,0.5);
          font-weight: 500;
        }
        .notification.success { border-color: var(--light-green); }
        .notification.warning { border-color: #f59e0b; }

        .footer {
          text-align: center; margin-top: 30px; padding: 15px;
          border-top: 1px solid var(--border); color: #555;
          font-size: 0.8rem;
        }
        .footer .reset-btn {
          color: var(--gold); cursor: pointer; font-weight: 500; margin-top: 8px;
        }
    </style>
</head>
<body>

    <div class="shalawat-bar">
        <div class="marquee">
            Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ ØµÙÙ„ÙÙ‘ Ø¹ÙÙ„ÙÙ‰ Ø³ÙÙŠÙÙ‘Ø¯ÙÙ†ÙØ§ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø¢Ù„Ù Ø³ÙÙŠÙÙ‘Ø¯ÙÙ†ÙØ§ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù â€” SIF AL FIKRI DREAM OS V6.0.6 â€” SEMANGAT KERJA BERKAH UNTUK SEMUA â€” 
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <div class="quantum-container">
        <div class="header">
            <div class="icon-wrapper">
                <i class="fas fa-atom"></i>
                <div class="icon-badge">V6.0</div>
            </div>
            <p style="color: var(--light-green); font-size: 0.7rem; letter-spacing: 2px;">SIF AL FIKRI SYSTEM</p>
            <h1>DREAM OS</h1>
        </div>

        <div id="mainMenu" class="menu-grid">
            <div class="menu-card" onclick="showForm('bookingForm')">
                <i class="fas fa-calendar-check fa-2x" style="color:var(--gold)"></i>
                <span>BOOKING</span>
            </div>
            <div class="menu-card" onclick="showForm('k3Form'); startCamera();">
                <i class="fas fa-tools fa-2x" style="color:var(--light-green)"></i>
                <span>LAPOR K3</span>
            </div>
            <div class="menu-card" onclick="showForm('assetForm'); loadAssets();">
                <i class="fas fa-boxes fa-2x" style="color:#5dade2"></i>
                <span>ASSET</span>
            </div>
            <div class="menu-card" onclick="location.reload()">
                <i class="fas fa-sync-alt fa-2x" style="color:#aab7b8"></i>
                <span>REFRESH</span>
            </div>
        </div>

        <div id="bookingForm" class="form-container">
            <h2 style="color:var(--gold); font-family:'Orbitron'; font-size:1.1rem; margin-bottom:10px;">ğŸ“… Booking Sarana</h2>
            <form onsubmit="handleBooking(event)">
                <input type="text" id="nama" class="input-field" placeholder="Nama PIC" required>
                <select id="divisi" class="input-field" required>
                    <option value="">-- Unit --</option>
                    <option value="Unit SD">Unit SD</option><option value="Unit SMP">Unit SMP</option><option value="Unit SMA">Unit SMA</option>
                </select>
                <select id="sarana" class="input-field" required>
                    <option value="Aula Utama">Aula Utama</option><option value="Lab Komputer">Lab Komputer</option>
                </select>
                <input type="date" id="tgl" class="input-field" required>
                <button type="submit" class="btn-submit">KIRIM WA</button>
                <button type="button" class="btn-submit btn-secondary" onclick="hideForms()">BATAL</button>
            </form>
        </div>

        <div id="k3Form" class="form-container">
            <h2 style="color:var(--light-green); font-family:'Orbitron'; font-size:1.1rem; margin-bottom:10px;">ğŸš¨ Laporan K3</h2>
            <div id="cameraContainer"><video id="cameraPreview" autoplay playsinline></video></div>
            <form onsubmit="handleK3(event)">
                <input type="text" id="lokasi" class="input-field" placeholder="Lokasi" required>
                <textarea id="masalah" class="input-field" placeholder="Masalah..." rows="3"></textarea>
                <button type="submit" class="btn-submit">LAPORKAN</button>
                <button type="button" class="btn-submit btn-secondary" onclick="stopCamera(); hideForms()">BATAL</button>
            </form>
        </div>

        <div id="assetForm" class="form-container">
            <h2 style="color:#5dade2; font-family:'Orbitron'; font-size:1.1rem; margin-bottom:10px;">ğŸ“¦ Inventaris</h2>
            <input type="text" id="searchAsset" class="input-field" placeholder="Cari..." onkeyup="filterAssets()">
            <div class="asset-list" id="assetDisplay"></div>
            <input type="text" id="newAsset" class="input-field" placeholder="Tambah baru..." style="margin-top:15px;">
            <button onclick="addAsset()" class="btn-submit" style="background:#5dade2">SIMPAN</button>
            <button type="button" class="btn-submit btn-secondary" onclick="hideForms()">KEMBALI</button>
        </div>

        <div class="footer">
            <p>APPROVED BY: PAK HANUNG & PAK ERWIN</p>
            <p class="reset-btn" onclick="clearCache()">[ RESET SYSTEM ]</p>
        </div>
    </div>
    
    <script>
        const CONFIG = { ADMIN_WA: "628886183954" };
        let cameraStream = null;

        function notify(msg, type = 'success') {
            const el = document.getElementById('notification');
            el.textContent = msg; 
            el.className = `notification ${type}`;
            el.style.display = 'block';
            setTimeout(() => { el.style.display = 'none'; }, 3000);
        }

        function showForm(id) {
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById(id).style.display = 'block';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function hideForms() {
            stopCamera();
            document.querySelectorAll('.form-container').forEach(f => f.style.display = 'none');
            document.getElementById('mainMenu').style.display = 'grid';
        }

        // --- WHATSAPP SENDER (FIXED) - gabungan solusi Qwen & Gemini ---
        function sendWA(text) {
            const cleanWA = CONFIG.ADMIN_WA.replace(/\D/g, '');
            notify("ğŸš€ Mengirim ke WhatsApp...", "success");
            setTimeout(() => {
                window.location.href = `https://wa.me/${cleanWA}?text=${encodeURIComponent(text)}`;
            }, 800);
        }

        // --- CAMERA LOGIC (SAMSUNG A15 SAFE) - optimized dari Gemini ---
        async function startCamera() {
            const video = document.getElementById('cameraPreview');
            const container = document.getElementById('cameraContainer');
            
            try {
                const constraints = { 
                    video: { 
                        facingMode: "environment", 
                        width: { ideal: 640 }, 
                        height: { ideal: 480 } 
                    } 
                };
                cameraStream = await navigator.mediaDevices.getUserMedia(constraints);
                video.srcObject = cameraStream;
                container.style.display = 'block';
                notify("âœ… Kamera aktif!", "success");
            } catch (e) {
                console.error("Camera error:", e);
                if (e.name === 'NotAllowedError') {
                    notify("ğŸ“¸ Kamera ditolak! Isi form manual.", "warning");
                    document.querySelector('#k3Form textarea').focus();
                } else {
                    notify("âŒ Kamera tidak tersedia di HP ini", "warning");
                }
            }
        }

        function stopCamera() {
            if (cameraStream) {
                cameraStream.getTracks().forEach(track => track.stop());
                cameraStream = null;
            }
            document.getElementById('cameraContainer').style.display = 'none';
        }

        // --- ASSET MANAGEMENT - dari versi lengkap ---
        function loadAssets() {
            const assets = JSON.parse(localStorage.getItem('assets') || '["Proyektor Aula", "Sound System", "Kursi Lipat"]');
            renderAssets(assets);
        }

        function renderAssets(list) {
            const container = document.getElementById('assetDisplay');
            if (list.length === 0) {
                container.innerHTML = '<div style="text-align:center; padding:20px; color:#555;">Tidak ada asset tersimpan</div>';
                return;
            }
            container.innerHTML = list.map(a => `
                <div class="asset-item">
                    <span>ğŸ“¦ ${a}</span>
                    <i class="fas fa-check-circle" style="color:var(--light-green);"></i>
                </div>
            `).join('');
        }

        function filterAssets() {
            const q = document.getElementById('searchAsset').value.toLowerCase();
            const assets = JSON.parse(localStorage.getItem('assets') || '[]');
            renderAssets(assets.filter(a => a.toLowerCase().includes(q)));
        }

        function addAsset() {
            const val = document.getElementById('newAsset').value.trim();
            if(!val) {
                notify("âŒ Isi nama asset!", "warning");
                return;
            }
            const assets = JSON.parse(localStorage.getItem('assets') || '[]');
            assets.push(val);
            localStorage.setItem('assets', JSON.stringify(assets));
            document.getElementById('newAsset').value = '';
            loadAssets();
            notify("âœ… Asset berhasil disimpan!", "success");
        }

        // --- FORM SUBMITS - fix WhatsApp link ---
        function handleBooking(e) {
            e.preventDefault();
            const msg = `*BOOKING DREAM OS*\nPIC: ${document.getElementById('nama').value}\nUnit: ${document.getElementById('divisi').value}\nSarana: ${document.getElementById('sarana').value}\nTanggal: ${document.getElementById('tgl').value}`;
            sendWA(msg);
        }

        function handleK3(e) {
            e.preventDefault();
            const msg = `ğŸš¨ *LAPORAN K3 DREAM OS*\nLokasi: ${document.getElementById('lokasi').value}\nMasalah: ${document.getElementById('masalah').value}\nDilaporkan via Dream OS v6.0`;
            sendWA(msg);
            stopCamera();
        }

        function clearCache() {
            if(confirm("Reset semua data aplikasi? Data booking & asset akan hilang.")) { 
                localStorage.clear(); 
                location.reload(); 
            }
        }

        // --- AUTO CLEANUP & INIT - dari versi lengkap ---
        document.addEventListener('visibilitychange', () => {
            if (document.visibilityState === 'hidden') {
                stopCamera();
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            notify("âœ¨ Allahumma Sholli 'ala Sayyidina Muhammad", "success");
            document.getElementById('tgl').min = new Date().toISOString().split('T')[0];
        });

        // --- GHOST MODE (5x klik logo) - dari DSeek ---
        let ghostClicks = 0;
        let lastGhostClick = 0;
        
        document.querySelector('.header h1').addEventListener('click', () => {
            const now = Date.now();
            if (now - lastGhostClick > 2000) {
                ghostClicks = 0;
            }
            ghostClicks++;
            lastGhostClick = now;
            
            if(ghostClicks >= 5) {
                notify("ğŸ‘» GHOST MODE ACTIVE", "warning");
                ghostClicks = 0;
            }
        });
    </script>
</body>
</html>
