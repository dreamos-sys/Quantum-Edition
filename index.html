<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DREAM OS ULTIMATE v10.5 | SIF ERP COMPLETE</title>
    <style>
        /* ========== QUANTUM CSS - ULTRA FAST ========== */
        * {
            margin: 0; padding: 0; box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            transition: none !important;
            animation: none !important;
            transform: none !important;
            scroll-behavior: auto !important;
        }

        :root {
            --bg: #0a0f1e; --card: #151a2d; --gold: #fbbf24;
            --green: #10b981; --red: #ef4444; --blue: #3b82f6;
            --purple: #8b5cf6; --orange: #f97316; --cyan: #06b6d4;
            --dark: #0f172a;
        }

        body {
            background: var(--bg); color: #e2e8f0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -webkit-transform: translateZ(0);
            transform: translateZ(0);
        }

        /* HEADER */
        .header {
            text-align: center;
            padding: 20px 15px 15px;
            background: linear-gradient(180deg, var(--bg) 0%, rgba(10, 15, 30, 0.9) 100%);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 2px solid var(--green);
        }

        /* MAIN CARDS */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            padding: 15px;
        }

        .hub-card {
            background: var(--card);
            border: 2px solid;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
        }

        .hub-card:active {
            background: rgba(59, 130, 246, 0.15);
        }

        .hub-service { border-color: var(--blue); }
        .hub-asset { border-color: var(--purple); }
        .hub-admin { border-color: var(--gold); display: none; }

        .hub-title {
            font-size: 1.3rem;
            font-weight: 800;
            margin-bottom: 5px;
            color: white;
        }

        .hub-subtitle {
            font-size: 0.75rem;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .hub-icon {
            font-size: 2.5rem;
            text-align: right;
            margin-top: -15px;
        }

        /* VIEW SYSTEM */
        .view {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: var(--bg);
            z-index: 2000;
            padding: 15px;
            overflow-y: auto;
        }

        /* BUTTONS */
        .btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            margin: 8px 0;
            background: #334155;
            color: white;
        }

        .btn-primary { background: var(--green); color: white; }
        .btn-secondary { background: var(--blue); color: white; }
        .btn-danger { background: var(--red); color: white; }
        .btn-warning { background: var(--orange); color: white; }
        .btn-gold { background: var(--gold); color: black; font-weight: 800; }
        .btn-purple { background: var(--purple); color: white; }

        /* FORMS */
        .form-group { margin-bottom: 15px; }
        .form-label { display: block; color: var(--gold); font-size: 0.9rem; margin-bottom: 5px; font-weight: 600; }
        .form-input {
            width: 100%;
            padding: 14px;
            background: #1e293b;
            border: 1.5px solid #475569;
            border-radius: 8px;
            color: white;
            font-size: 16px;
        }
        .form-input:focus { border-color: var(--gold); outline: none; }
        .form-textarea { min-height: 100px; resize: vertical; }

        /* TIME GRID */
        .time-grid { 
            display: grid; 
            grid-template-columns: 1fr auto 1fr; 
            gap: 10px; 
            align-items: center; 
        }
        .time-separator { 
            text-align: center; 
            color: var(--gold); 
            font-size: 1.5rem; 
            font-weight: bold; 
        }

        /* KAMERA SYSTEM */
        .camera-container {
            position: relative;
            width: 100%;
            border-radius: 12px;
            overflow: hidden;
            margin: 15px 0;
            border: 2px solid var(--blue);
            background: #000;
        }
        .camera-preview {
            width: 100%;
            height: 250px;
            object-fit: contain;
            background: #1e293b;
        }
        .camera-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .camera-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }
        .scan-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            border: 3px solid #0ea5e9;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(14, 165, 233, 0.5);
            pointer-events: none;
            z-index: 10;
            display: none;
        }

        /* PHOTO PREVIEW */
        .photo-preview {
            margin: 15px 0;
            display: none;
        }
        .photo-preview img {
            width: 100%;
            border-radius: 10px;
            border: 2px solid var(--red);
        }

        /* MODALS */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 3000;
            padding: 20px;
        }
        .modal-content {
            background: var(--card);
            border-radius: 15px;
            padding: 25px;
            max-width: 400px;
            margin: 50px auto;
            border: 2px solid var(--gold);
        }

        /* STATUS BAR */
        .status-bar {
            position: fixed;
            bottom: 0; left: 0;
            width: 100%;
            background: var(--dark);
            padding: 8px 15px;
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            border-top: 1px solid #334155;
            z-index: 1000;
        }

        /* LOADER */
        #loader {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: var(--bg);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #1e293b;
            border-top: 4px solid var(--green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* TOAST */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--green);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 700;
            z-index: 4000;
            display: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        .toast-error { background: var(--red); }

        /* RULES BOX */
        .rules-box {
            background: rgba(239, 68, 68, 0.1);
            border-left: 3px solid var(--red);
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
        }

        /* BADGES */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 700;
            margin: 2px;
        }
        .badge-green { background: var(--green); color: white; }
        .badge-blue { background: var(--blue); color: white; }
        .badge-red { background: var(--red); color: white; }
        .badge-orange { background: var(--orange); color: white; }
        .badge-purple { background: var(--purple); color: white; }

        /* AI STATUS */
        .ai-status {
            background: rgba(6, 182, 212, 0.1);
            border-left: 3px solid var(--cyan);
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>

    <!-- LOADER -->
    <div id="loader">
        <div class="spinner"></div>
        <p style="margin-top: 15px; color: var(--gold); font-size: 0.9rem;">QUANTUM AI SYSTEM LOADING...</p>
    </div>

    <!-- HEADER -->
    <div class="header">
        <div onclick="system.architectTrigger()" style="font-size: 3rem; cursor: pointer; margin-bottom: 5px;">üöÄ</div>
        <h1 style="color: var(--gold); font-size: 1.5rem; letter-spacing: 1px;">DREAM OS ULTIMATE v10.5</h1>
        <p style="color: var(--green); font-size: 0.75rem; margin-top: 3px;">
            SIF AL FIKRI ERP ‚Ä¢ 18 SARANA ‚Ä¢ 12 ALAT ‚Ä¢ REAL-TIME
        </p>
        <p style="color: #94a3b8; font-size: 0.65rem; margin-top: 2px;">
            ÿ®Ÿêÿ≥ŸíŸÖŸê ÿßŸÑŸÑŸáŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸ∞ŸÜŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸêŸäŸíŸÖŸê üáÆüá© üáµüá∏
        </p>
    </div>

    <!-- MAIN DASHBOARD -->
    <div id="mainView" class="main-grid">
        <div class="hub-card hub-service" onclick="system.showView('service')">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <div class="hub-title">SERVICE HUB</div>
                    <div class="hub-subtitle">Booking ‚Ä¢ K3 ‚Ä¢ Security ‚Ä¢ Calendar</div>
                </div>
                <div class="hub-icon">üèõÔ∏è</div>
            </div>
            <div style="margin-top: 10px; font-size: 0.8rem; color: #94a3b8;">
                Akses booking 18 sarana & laporan lengkap
            </div>
        </div>

        <div class="hub-card hub-asset" onclick="system.showView('asset')">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <div class="hub-title">ASSET HUB</div>
                    <div class="hub-subtitle">Inventory ‚Ä¢ Warehouse ‚Ä¢ QR Scan ‚Ä¢ Print</div>
                </div>
                <div class="hub-icon">üì¶</div>
            </div>
            <div style="margin-top: 10px; font-size: 0.8rem; color: #94a3b8;">
                12 alat terinventarisasi dengan sistem QR code
            </div>
        </div>

        <div id="adminCard" class="hub-card hub-admin" onclick="system.showView('admin')">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <div class="hub-title" style="color: var(--gold);">COMMAND HUB</div>
                    <div class="hub-subtitle">Admin ‚Ä¢ Monitor ‚Ä¢ Reports ‚Ä¢ Database</div>
                </div>
                <div class="hub-icon">üõ∞Ô∏è</div>
            </div>
            <div style="margin-top: 10px; font-size: 0.8rem; color: #fbbf24;">
                Full system control & monitoring access
            </div>
        </div>

        <div style="text-align: center; margin-top: 20px;">
            <button class="btn btn-gold" onclick="system.startLiveDemo()" style="font-size: 0.9rem; padding: 12px;">
                üé¨ START LIVE DEMO FOR RAKER
            </button>
        </div>
    </div>

    <!-- ==================== SERVICE VIEWS ==================== -->

    <!-- SERVICE VIEW -->
    <div id="serviceView" class="view">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="color: var(--blue);">SERVICE HUB</h2>
            <button onclick="system.showMain()" style="background: none; border: none; color: white; font-size: 2rem;">√ó</button>
        </div>

        <button class="btn btn-primary" onclick="system.showView('booking')">
            üìÖ BOOKING SARANA (18 UNIT)
        </button>

        <button class="btn btn-danger" onclick="system.showView('k3')">
            üõ°Ô∏è LAPORAN K3 + KAMERA
        </button>

        <button class="btn btn-warning" onclick="system.showView('security')">
            üíÇ LAPORAN SEKURITI
        </button>

        <button class="btn btn-secondary" onclick="system.showView('calendar')">
            üìÜ LIVE CALENDAR
        </button>

        <div class="ai-status">
            <strong>ü§ñ QUANTUM AI ACTIVE:</strong> DeepSeek + Qwen monitoring system
        </div>
    </div>

    <!-- BOOKING VIEW -->
    <div id="bookingView" class="view">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="color: var(--green);">BOOKING SARANA</h2>
            <button onclick="system.showView('service')" style="background: none; border: none; color: white; font-size: 2rem;">√ó</button>
        </div>

        <!-- SARANA SELECTION -->
        <div class="form-group">
            <label class="form-label">Pilih Sarana (18 Unit)</label>
            <select class="form-input" id="bookingSarana" onchange="system.checkSaranaRules(this.value)">
                <option value="">-- Pilih Sarana --</option>
                <optgroup label="üèõÔ∏è AULA">
                    <option value="Aula SMP">Aula SMP (Sound, Lighting, AC, Projector)</option>
                    <option value="Aula SMA">Aula SMA (Sound, Projector)</option>
                    <option value="Serbaguna">Serba Guna (Sound)</option>
                </optgroup>
                <optgroup label="üåø SAUNG & OUTDOOR">
                    <option value="Saung Besar">Saung Besar (Sound)</option>
                    <option value="Saung Kecil">Saung Kecil</option>
                    <option value="Lapangan Volley">Lapangan Volley</option>
                    <option value="Lapangan Basket">Lapangan Basket</option>
                    <option value="Lapangan SMA">Lapangan SMA</option>
                    <option value="Lapangan Tanah">Lapangan Tanah</option>
                </optgroup>
                <optgroup label="üíª LAB KOMPUTER">
                    <option value="Labkom SD">Lab Komputer SD</option>
                    <option value="Labkom SMP">Lab Komputer SMP</option>
                    <option value="Labkom SMA">Lab Komputer SMA</option>
                </optgroup>
                <optgroup label="üçΩÔ∏è KANTIN">
                    <option value="Kantin SMP">Kantin SMP</option>
                    <option value="Kantin SMA">Kantin SMA</option>
                </optgroup>
                <optgroup label="üìö PERPUSTAKAAN">
                    <option value="Perpus SD">Perpustakaan SD</option>
                    <option value="Perpus SMP">Perpustakaan SMP</option>
                    <option value="Perpus SMA">Perpustakaan SMA</option>
                </optgroup>
                <optgroup label="üïå MASJID (MAINTENANCE)">
                    <option value="Masjid" disabled>Masjid - MAINTENANCE/RENOVASI</option>
                </optgroup>
            </select>
        </div>

        <!-- PIC & UNIT -->
        <div class="form-group">
            <label class="form-label">Nama PIC / Guru *</label>
            <input type="text" class="form-input" id="bookingPIC" placeholder="Nama lengkap">
        </div>

        <div class="form-group">
            <label class="form-label">Unit *</label>
            <select class="form-input" id="bookingUnit">
                <option value="">-- Pilih Unit --</option>
                <option value="SD">SD</option>
                <option value="SMP">SMP</option>
                <option value="SMA">SMA</option>
                <option value="IT">IT</option>
                <option value="UMUM">UMUM</option>
            </select>
        </div>

        <!-- DATE -->
        <div class="form-group">
            <label class="form-label">Tanggal Booking *</label>
            <input type="date" class="form-input" id="bookingDate" onchange="system.checkDateRules()">
        </div>

        <!-- TIME RANGE -->
        <div class="form-group">
            <label class="form-label">Waktu Booking *</label>
            <div class="time-grid">
                <input type="time" class="form-input" id="bookingStart" value="07:30" onchange="system.checkTimeRules()">
                <div class="time-separator">‚Üí</div>
                <input type="time" class="form-input" id="bookingEnd" value="16:00" onchange="system.checkTimeRules()">
            </div>
            <p style="color: #94a3b8; font-size: 0.7rem; margin-top: 5px;">
                Format: Jam Mulai ‚Üí Jam Selesai (Minimal 1 jam, Maksimal 4 jam)
            </p>
        </div>

        <!-- NOTE -->
        <div class="form-group">
            <label class="form-label">Keterangan Acara</label>
            <textarea class="form-input form-textarea" id="bookingNote" placeholder="Detail keperluan acara..."></textarea>
        </div>

        <!-- RULES -->
        <div class="rules-box">
            <p style="color: var(--red); font-size: 0.8rem; font-weight: 700;">‚ö†Ô∏è ATURAN BOOKING:</p>
            <p style="color: #fca5a5; font-size: 0.75rem;">
                ‚Ä¢ Senin-Jumat: 07:30 - 16:00 WIB<br>
                ‚Ä¢ Jumat: 10:30-13:00 (Aula SMP & Serba Guna LOCK)<br>
                ‚Ä¢ Masjid: MAINTENANCE (tidak bisa digunakan)<br>
                ‚Ä¢ Durasi maksimal: 4 jam per booking
            </p>
        </div>

        <!-- ALERTS -->
        <div id="bookingAlert" style="display: none; background: rgba(251, 191, 36, 0.1); padding: 12px; border-radius: 8px; margin: 15px 0; border-left: 3px solid var(--orange);">
            <p style="color: var(--orange); font-size: 0.8rem; font-weight: 700;" id="alertTitle"></p>
            <p style="color: #fde68a; font-size: 0.75rem;" id="alertMessage"></p>
        </div>

        <!-- ACTION BUTTONS -->
        <button class="btn btn-primary" onclick="system.sendBooking()">
            üì± KIRIM KE PAK ERWIN
        </button>

        <button class="btn btn-warning" onclick="system.checkAvailability()">
            üîç CEK KETERSEDIAAN
        </button>
    </div>

    <!-- K3 VIEW WITH CAMERA -->
    <div id="k3View" class="view">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="color: var(--red);">LAPORAN K3</h2>
            <button onclick="system.showView('service')" style="background: none; border: none; color: white; font-size: 2rem;">√ó</button>
        </div>

        <div style="text-align: center; margin: 20px 0;">
            <div style="font-size: 4rem; color: var(--red);">‚ö†Ô∏è</div>
            <p style="color: var(--gold); font-weight: 700; margin-top: 10px;">LAPORAN KECELAKAN / POTENSI BAHAYA</p>
            <p style="color: #94a3b8; font-size: 0.85rem; margin-top: 5px;">Dengan bukti foto untuk dokumentasi</p>
        </div>

        <!-- K3 FORM -->
        <div class="form-group">
            <label class="form-label">Lokasi Kejadian *</label>
            <input type="text" class="form-input" id="k3Location" placeholder="Contoh: Labkom SMP, Aula SMA, dll">
        </div>

        <div class="form-group">
            <label class="form-label">Jenis Laporan *</label>
            <select class="form-input" id="k3Type">
                <option value="">-- Pilih Jenis --</option>
                <option value="Kecelakaan Kerja">Kecelakaan Kerja</option>
                <option value="Potensi Bahaya">Potensi Bahaya</option>
                <option value="Keamanan">Keamanan</option>
                <option value="Kebersihan">Kebersihan</option>
                <option value="Fasilitas Rusak">Fasilitas Rusak</option>
                <option value="Lainnya">Lainnya</option>
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">Deskripsi Lengkap *</label>
            <textarea class="form-input form-textarea" id="k3Description" placeholder="Jelaskan kejadian dengan detail..."></textarea>
        </div>

        <!-- K3 CAMERA -->
        <div class="camera-container">
            <video class="camera-preview" id="k3CameraPreview" autoplay playsinline></video>
            <div class="scan-overlay" id="k3ScanOverlay"></div>
            
            <div class="camera-controls">
                <button class="camera-btn" style="background: #10b981;" onclick="system.startCamera('k3')">
                    üì∏ BUKA KAMERA
                </button>
                <button class="camera-btn" style="background: #3b82f6;" onclick="system.capturePhoto('k3')">
                    üì∑ AMBIL FOTO
                </button>
                <button class="camera-btn" style="background: #ef4444;" onclick="system.stopCamera('k3')">
                    ‚èπÔ∏è TUTUP
                </button>
            </div>
        </div>

        <!-- PHOTO PREVIEW -->
        <div id="k3PhotoPreview" class="photo-preview">
            <p style="color: var(--gold); font-size: 0.9rem; margin-bottom: 8px;">üì∏ BUKTI FOTO KEJADIAN:</p>
            <img id="k3Photo" src="" style="width: 100%; border-radius: 10px; border: 2px solid var(--red);">
        </div>

        <!-- MANUAL INPUT FALLBACK -->
        <div id="k3ManualInput" style="display: none; margin: 15px 0; padding: 15px; background: rgba(59, 130, 246, 0.1); border-radius: 12px;">
            <p style="color: var(--blue); font-size: 0.9rem; font-weight: 700; margin-bottom: 10px;">üíª INPUT MANUAL (Kamera Error)</p>
            <input type="text" class="form-input" id="k3ManualInputField" placeholder="Deskripsi bukti visual...">
            <button class="btn btn-blue" onclick="system.useManualInput('k3')" style="margin-top: 10px;">
                ‚úÖ GUNAKAN INPUT INI
            </button>
        </div>

        <!-- SEND BUTTON -->
        <button class="btn btn-danger" onclick="system.sendK3()">
            üö® KIRIM KE TEKNISI + FOTO
        </button>

        <div class="ai-status">
            <strong>üì∏ CATATAN:</strong> Foto akan otomatis tersimpan di cloud database
        </div>
    </div>

    <!-- SECURITY VIEW WITH CAMERA -->
    <div id="securityView" class="view">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="color: var(--orange);">LAPORAN SEKURITI</h2>
            <button onclick="system.showView('service')" style="background: none; border: none; color: white; font-size: 2rem;">√ó</button>
        </div>

        <div style="text-align: center; margin: 20px 0;">
            <div style="font-size: 4rem;">üíÇ</div>
            <p style="color: var(--gold); font-weight: 700; margin-top: 10px;">SISTEM LAPORAN SEKURITI</p>
            <p style="color: #94a3b8; font-size: 0.85rem; margin-top: 5px;">Check-in patroli & laporan keamanan</p>
        </div>

        <!-- SECURITY FORM -->
        <div class="form-group">
            <label class="form-label">Nama Petugas *</label>
            <input type="text" class="form-input" id="securityName" placeholder="Nama lengkap petugas">
        </div>

        <div class="form-group">
            <label class="form-label">Tipe Laporan *</label>
            <select class="form-input" id="securityType">
                <option value="">-- Pilih Tipe --</option>
                <option value="Check-in Patroli">Check-in Patroli</option>
                <option value="Laporan Keamanan">Laporan Keamanan</option>
                <option value="Insiden Keamanan">Insiden Keamanan</option>
                <option value="Check-out Patroli">Check-out Patroli</option>
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">Lokasi *</label>
            <select class="form-input" id="securityLocation">
                <option value="">-- Pilih Lokasi --</option>
                <option value="Pos Utama (Gerbang Depan)">Pos Utama (Gerbang Depan)</option>
                <option value="Pos Belakang">Pos Belakang</option>
                <option value="Pos Parkir Guru">Pos Parkir Guru</option>
                <option value="Pos Labkom">Pos Labkom</option>
                <option value="Area Parkir Siswa">Area Parkir Siswa</option>
                <option value="Area Olahraga">Area Olahraga</option>
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">Deskripsi *</label>
            <textarea class="form-input form-textarea" id="securityDescription" placeholder="Jelaskan kondisi keamanan..."></textarea>
        </div>

        <!-- SECURITY CAMERA -->
        <div class="camera-container">
            <video class="camera-preview" id="securityCameraPreview" autoplay playsinline></video>
            <div class="scan-overlay" id="securityScanOverlay"></div>
            
            <div class="camera-controls">
                <button class="camera-btn" style="background: #10b981;" onclick="system.startCamera('security')">
                    üì∏ BUKA KAMERA
                </button>
                <button class="camera-btn" style="background: #3b82f6;" onclick="system.capturePhoto('security')">
                    üì∑ AMBIL FOTO
                </button>
                <button class="camera-btn" style="background: #ef4444;" onclick="system.stopCamera('security')">
                    ‚èπÔ∏è TUTUP
                </button>
            </div>
        </div>

        <!-- PHOTO PREVIEW -->
        <div id="securityPhotoPreview" class="photo-preview">
            <p style="color: var(--gold); font-size: 0.9rem; margin-bottom: 8px;">üì∏ FOTO BUKTI:</p>
            <img id="securityPhoto" src="" style="width: 100%; border-radius: 10px; border: 2px solid var(--orange);">
        </div>

        <!-- SEND BUTTON -->
        <button class="btn btn-warning" onclick="system.sendSecurityReport()">
            ‚úÖ KIRIM LAPORAN SEKURITI
        </button>

        <!-- PROTOCOL -->
        <div class="rules-box">
            <p style="color: var(--orange); font-size: 0.8rem; font-weight: 700;">üìã PROTOKOL SEKURITI:</p>
            <p style="color: #fde68a; font-size: 0.75rem;">
                ‚Ä¢ Patroli pagi: 06:00-18:00<br>
                ‚Ä¢ Patroli malam: 18:00-06:00<br>
                ‚Ä¢ Wajib check-in setiap 2 jam<br>
                ‚Ä¢ Foto bukti wajib untuk dokumentasi
            </p>
        </div>
    </div>

    <!-- ==================== ASSET VIEWS ==================== -->

    <!-- ASSET VIEW -->
    <div id="assetView" class="view">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="color: var(--purple);">ASSET HUB</h2>
            <button onclick="system.showMain()" style="background: none; border: none; color: white; font-size: 2rem;">√ó</button>
        </div>

        <button class="btn btn-secondary" onclick="system.showView('inventory')">
            üì¶ INVENTORY (12 ALAT)
        </button>

        <button class="btn btn-warning" onclick="system.showView('warehouse')">
            üè¨ WAREHOUSE VAULT
        </button>

        <button class="btn btn-primary" onclick="system.showView('qrscanner')">
            üì∑ QR SCANNER
        </button>

        <button class="btn btn-purple" onclick="system.showView('smartprint')">
            üñ®Ô∏è SMART PRINT
        </button>

        <div style="margin-top: 20px;">
            <p style="color: var(--gold); font-size: 0.9rem; margin-bottom: 10px;">üîê VAULT ACCESS:</p>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button class="btn" style="background: #475569;" onclick="system.openVault('inventory')">
                    üîì INVENTORY VAULT
                </button>
                <button class="btn" style="background: #475569;" onclick="system.openVault('warehouse')">
                    üîì WAREHOUSE VAULT
                </button>
            </div>
        </div>
    </div>

    <!-- QR SCANNER VIEW -->
    <div id="qrscannerView" class="view">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="color: var(--blue);">QR SCANNER</h2>
            <button onclick="system.showView('asset')" style="background: none; border: none; color: white; font-size: 2rem;">√ó</button>
        </div>

        <div style="text-align: center; margin: 20px 0;">
            <div style="font-size: 4rem;">üì∑</div>
            <p style="color: var(--gold); font-weight: 700;">QR CODE SCANNER</p>
            <p style="color: #94a3b8; font-size: 0.85rem;">Scan kode QR untuk inventory & warehouse</p>
        </div>

        <!-- QR CAMERA -->
        <div class="camera-container">
            <video class="camera-preview" id="qrCameraPreview" autoplay playsinline></video>
            <div class="scan-overlay" id="qrScanOverlay"></div>
            
            <div class="camera-controls">
                <button class="camera-btn" style="background: #10b981;" onclick="system.startQRScanner()">
                    üîç SCAN QR
                </button>
                <button class="camera-btn" style="background: #3b82f6;" onclick="system.simulateQRScan()">
                    üéØ DEMO SCAN
                </button>
                <button class="camera-btn" style="background: #ef4444;" onclick="system.stopQRScanner()">
                    ‚èπÔ∏è STOP
                </button>
            </div>
        </div>

        <!-- MANUAL INPUT -->
        <div id="qrManualInput" style="margin: 20px 0; padding: 15px; background: rgba(59, 130, 246, 0.1); border-radius: 12px;">
            <p style="color: var(--blue); font-size: 0.9rem; font-weight: 700; margin-bottom: 10px;">üíª INPUT MANUAL QR CODE:</p>
            <input type="text" class="form-input" id="qrManualInputField" placeholder="Masukkan kode QR secara manual...">
            <button class="btn btn-blue" onclick="system.processManualQR()" style="margin-top: 10px;">
                ‚úÖ PROSES KODE
            </button>
        </div>

        <!-- SCAN RESULT -->
        <div id="qrResult" style="display: none; margin-top: 20px; padding: 15px; background: rgba(16, 185, 129, 0.1); border-radius: 12px;">
            <p style="color: var(--green); font-size: 0.9rem; font-weight: 700; margin-bottom: 10px;">üéâ HASIL SCAN:</p>
            <p id="qrResultText" style="color: white; font-weight: bold;"></p>
            <p id="qrResultDetails" style="color: #94a3b8; font-size: 0.8rem; margin-top: 5px;"></p>
        </div>
    </div>

    <!-- ==================== ADMIN VIEWS ==================== -->

    <!-- ADMIN VIEW -->
    <div id="adminView" class="view">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="color: var(--gold);">COMMAND HUB</h2>
            <button onclick="system.showMain()" style="background: none; border: none; color: white; font-size: 2rem;">√ó</button>
        </div>

        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 20px;">
            <button class="btn" style="background: var(--blue);" onclick="system.showView('monitor')">
                üì° MONITOR
            </button>
            <button class="btn" style="background: var(--purple);" onclick="system.showView('reports')">
                üìä REPORTS
            </button>
            <button class="btn" style="background: var(--green);" onclick="system.showView('database')">
                üóÑÔ∏è DATABASE
            </button>
        </div>

        <div style="margin-top: 20px;">
            <p style="color: var(--gold); font-size: 0.9rem; margin-bottom: 10px;">üîß SYSTEM TOOLS:</p>
            <button class="btn btn-warning" onclick="system.aiDiagnostic()">
                ü§ñ AI DIAGNOSTIC
            </button>
            <button class="btn btn-danger" onclick="system.systemReboot()">
                üîÑ SYSTEM REBOOT
            </button>
        </div>

        <div class="ai-status" style="margin-top: 20px;">
            <strong>ü§ñ QUANTUM AI ACTIVE:</strong> DeepSeek + Qwen monitoring system
        </div>
    </div>

    <!-- ==================== MODALS ==================== -->

    <!-- LOGIN MODAL -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="font-size: 3rem; color: var(--gold);">üîê</div>
                <h2 style="color: var(--gold);">SYSTEM ACCESS</h2>
                <p style="color: #94a3b8; font-size: 0.9rem;">Masukkan password sesuai level akses</p>
            </div>

            <div class="form-group">
                <input type="password" class="form-input" id="loginPassword" placeholder="Password" autocomplete="off">
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0;">
                <button class="btn" style="background: #475569; padding: 12px;" onclick="system.fillPassword('user_@1234')">
                    üë§ USER
                </button>
                <button class="btn" style="background: #475569; padding: 12px;" onclick="system.fillPassword('@dm1n_Sec2025')">
                    üëë ADMIN
                </button>
            </div>

            <button class="btn btn-gold" onclick="system.login()">
                üîì ACCESS SYSTEM
            </button>

            <button class="btn" style="background: #64748b; margin-top: 10px;" onclick="system.closeModal('loginModal')">
                CANCEL
            </button>
        </div>
    </div>

    <!-- VAULT MODAL -->
    <div id="vaultModal" class="modal">
        <div class="modal-content">
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="font-size: 3rem; color: var(--gold);">üóùÔ∏è</div>
                <h2 style="color: var(--gold);" id="vaultTitle">VAULT ACCESS</h2>
                <p style="color: #94a3b8; font-size: 0.9rem;" id="vaultSubtitle">Masukkan vault password</p>
            </div>

            <div class="form-group">
                <input type="password" class="form-input" id="vaultPassword" placeholder="Vault Password" autocomplete="off">
            </div>

            <button class="btn btn-gold" onclick="system.accessVault()">
                üîì UNLOCK VAULT
            </button>

            <button class="btn" style="background: #64748b; margin-top: 10px;" onclick="system.closeModal('vaultModal')">
                CANCEL
            </button>
        </div>
    </div>

    <!-- ==================== UTILITIES ==================== -->

    <!-- TOAST -->
    <div id="toast" class="toast"></div>

    <!-- STATUS BAR -->
    <div class="status-bar">
        <div id="clock">üïê 00:00:00</div>
        <div id="userStatus" style="color: var(--gold);">üë§ GUEST</div>
        <div id="systemStatus" style="color: var(--green);">üü¢ ONLINE</div>
    </div>

    <script>
        // =========================================
        // DREAM OS ULTIMATE v10.5 - COMPLETE SYSTEM
        // =========================================
        console.log(`
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë     DREAM OS ULTIMATE v10.5 - COMPLETE    ‚ïë
‚ïë   CAMERA WORKING 100% + QR SCANNER READY  ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
        `);

        const system = {
            // SYSTEM STATE
            currentView: 'main',
            architectClicks: 0,
            userRole: 'guest',
            vaultType: '',
            
            // CAMERA STATE
            cameraStream: null,
            cameraType: null,
            lastPhoto: null,
            isScanning: false,

            // SYSTEM MODE
            SYSTEM_MODE: {
                PRODUCTION: 'production',
                DEMO: 'demo',
                EMERGENCY: 'emergency'
            },
            currentMode: 'production',

            // COMPLETE DATA
            saranaData: [
                { id: 1, name: 'Aula SMP', equipment: ['Sound', 'Lighting', 'AC', 'Projector'], fridayLock: true },
                { id: 2, name: 'Aula SMA', equipment: ['Sound', 'Projector'], fridayLock: false },
                { id: 3, name: 'Saung Besar', equipment: ['Sound'], fridayLock: false },
                { id: 4, name: 'Saung Kecil', equipment: [], fridayLock: false },
                { id: 5, name: 'Masjid', equipment: ['Sound'], status: 'MAINTENANCE', available: false },
                { id: 6, name: 'Serbaguna', equipment: ['Sound'], fridayLock: true },
                { id: 7, name: 'Labkom SD', equipment: ['Komputer'], type: 'Lab' },
                { id: 8, name: 'Labkom SMP', equipment: ['Komputer'], type: 'Lab' },
                { id: 9, name: 'Labkom SMA', equipment: ['Komputer'], type: 'Lab' },
                { id: 10, name: 'Lapangan Volley', equipment: [], type: 'Sports' },
                { id: 11, name: 'Lapangan Basket', equipment: [], type: 'Sports' },
                { id: 12, name: 'Lapangan SMA', equipment: [], type: 'Sports' },
                { id: 13, name: 'Lapangan Tanah', equipment: [], type: 'Sports' },
                { id: 14, name: 'Kantin SMP', equipment: [], type: 'Canteen' },
                { id: 15, name: 'Kantin SMA', equipment: [], type: 'Canteen' },
                { id: 16, name: 'Perpus SD', equipment: [], type: 'Library' },
                { id: 17, name: 'Perpus SMP', equipment: [], type: 'Library' },
                { id: 18, name: 'Perpus SMA', equipment: [], type: 'Library' }
            ],

            inventoryData: [
                { id: 1, name: 'Sound Portable', category: 'Audio', quantity: 4, location: 'Gudang A' },
                { id: 2, name: 'Projector', category: 'Visual', quantity: 10, location: 'Gudang B' },
                { id: 3, name: 'Mic Standing', category: 'Audio', quantity: 8, location: 'Gudang A' },
                { id: 4, name: 'Meja Panjang', category: 'Furniture', quantity: 15, location: 'Warehouse' },
                { id: 5, name: 'Meja Siswa', category: 'Furniture', quantity: 200, location: 'Warehouse' },
                { id: 6, name: 'Meja Oshin', category: 'Furniture', quantity: 50, location: 'Warehouse' },
                { id: 7, name: 'Kursi Futura', category: 'Furniture', quantity: 100, location: 'Warehouse' },
                { id: 8, name: 'Kursi Chitose', category: 'Furniture', quantity: 80, location: 'Warehouse' },
                { id: 9, name: 'Kursi Siswa', category: 'Furniture', quantity: 300, location: 'Warehouse' },
                { id: 10, name: 'Kabel HDMI', category: 'Cable', quantity: 25, location: 'Gudang C' },
                { id: 11, name: 'Kabel VGA', category: 'Cable', quantity: 20, location: 'Gudang C' },
                { id: 12, name: 'Kabel Rol AC', category: 'Cable', quantity: 15, location: 'Gudang C' }
            ],

            // ========== INITIALIZATION ==========
            init: function() {
                // Start clock
                this.updateClock();
                setInterval(() => this.updateClock(), 1000);
                
                // Set demo mode for today
                const today = new Date();
                if (today.getDate() === 7 && today.getMonth() === 0) { // 7 Jan 2026
                    this.currentMode = this.SYSTEM_MODE.DEMO;
                    console.log('üöÄ DEMO MODE AKTIF UNTUK RAKER!');
                }
                
                // Check camera support
                this.checkCameraSupport();
                
                // Show main view
                this.showMain();
                
                // Hide loader
                setTimeout(() => {
                    document.getElementById('loader').style.display = 'none';
                    
                    // Auto-show login modal
                    setTimeout(() => {
                        this.showModal('loginModal');
                    }, 500);
                }, 1000);
                
                console.log('‚úÖ System initialized - Mode:', this.currentMode);
            },

            // ========== VIEW MANAGEMENT ==========
            showView: function(viewId) {
                // Stop any active camera
                this.stopAllCameras();
                
                // Hide all views
                document.querySelectorAll('.view').forEach(v => v.style.display = 'none');
                document.getElementById('mainView').style.display = 'none';
                
                // Show target view
                if (viewId === 'main') {
                    document.getElementById('mainView').style.display = 'block';
                } else {
                    const view = document.getElementById(viewId + 'View');
                    if (view) view.style.display = 'block';
                }
                
                this.currentView = viewId;
            },

            showMain: function() {
                this.showView('main');
            },

            // ========== MODAL MANAGEMENT ==========
            showModal: function(modalId) {
                document.getElementById(modalId).style.display = 'block';
            },

            closeModal: function(modalId) {
                document.getElementById(modalId).style.display = 'none';
            },

            // ========== LOGIN SYSTEM ==========
            login: function() {
                const password = document.getElementById('loginPassword').value;
                const passwords = {
                    'user_@1234': { role: 'user', view: 'service' },
                    '@dm1n_Sec2025': { role: 'admin', view: 'admin' },
                    '418626': { role: 'architect', view: 'admin' },
                    'Mr.M_Architect_2025': { role: 'master', view: 'admin' }
                };
                
                if (passwords[password]) {
                    const data = passwords[password];
                    this.userRole = data.role;
                    
                    // Update UI
                    document.getElementById('userStatus').textContent = this.getRoleIcon() + ' ' + data.role.toUpperCase();
                    document.getElementById('userStatus').style.color = 'var(--gold)';
                    
                    // Show admin card for admin/architect/master
                    if (['admin', 'architect', 'master'].includes(data.role)) {
                        document.getElementById('adminCard').style.display = 'block';
                    }
                    
                    this.closeModal('loginModal');
                    this.showToast('‚úÖ Access granted: ' + data.role.toUpperCase());
                    
                    // Auto-navigate
                    setTimeout(() => this.showView(data.view), 500);
                    
                } else {
                    this.showToast('‚ùå Wrong password!', true);
                }
            },

            getRoleIcon: function() {
                const icons = {
                    'user': 'üë§',
                    'admin': 'üëë',
                    'architect': 'üèóÔ∏è',
                    'master': 'üîì',
                    'guest': 'üë§'
                };
                return icons[this.userRole] || 'üë§';
            },

            fillPassword: function(password) {
                document.getElementById('loginPassword').value = password;
            },

            // ========== ARCHITECT MODE ==========
            architectTrigger: function() {
                this.architectClicks++;
                
                if (this.architectClicks === 3) {
                    this.showToast('üîì 2 more clicks for Architect Mode');
                }
                
                if (this.architectClicks >= 5) {
                    this.activateArchitectMode();
                    this.architectClicks = 0;
                }
            },

            activateArchitectMode: function() {
                this.userRole = 'architect';
                document.getElementById('adminCard').style.display = 'block';
                document.getElementById('userStatus').textContent = 'üèóÔ∏è ARCHITECT';
                document.getElementById('userStatus').style.color = 'var(--purple)';
                
                // Show all vaults
                this.showToast('üèóÔ∏è ARCHITECT MODE ACTIVATED - All access granted');
                
                // Display master keys
                const keys = `
                    üîê MASTER KEYS:
                    ‚Ä¢ User: user_@1234
                    ‚Ä¢ Admin: @dm1n_Sec2025
                    ‚Ä¢ Architect: 418626
                    ‚Ä¢ Inventory Vault: 4dm1in_6969@01
                    ‚Ä¢ Warehouse Vault: 4dm1n_9696@02
                    ‚Ä¢ Master Key: Mr.M_Architect_2025
                    
                    üìû PAK ERWIN: +62 888-6183-954
                    üìß TEKNISI: teknisi@alfikri.sch.id
                `;
                
                alert(keys);
            },

            // ========== BOOKING SYSTEM ==========
            checkSaranaRules: function(saranaName) {
                if (saranaName === 'Masjid') {
                    this.showAlert('üîß MAINTENANCE', 'Masjid sedang dalam renovasi, tidak bisa dibooking');
                    document.getElementById('bookingSarana').value = '';
                }
            },

            checkDateRules: function() {
                const dateInput = document.getElementById('bookingDate').value;
                if (!dateInput) return true;
                
                const selectedDate = new Date(dateInput);
                const day = selectedDate.getDay();
                
                // Check if weekend
                if (day === 0 || day === 6) {
                    this.showAlert('üìÖ AKHIR PEKAN', 'Tidak bisa booking di hari Sabtu/Minggu');
                    return false;
                }
                
                return true;
            },

            checkTimeRules: function() {
                const startTime = document.getElementById('bookingStart').value;
                const endTime = document.getElementById('bookingEnd').value;
                
                if (!startTime || !endTime) return true;
                
                const [startHour, startMinute] = startTime.split(':').map(Number);
                const [endHour, endMinute] = endTime.split(':').map(Number);
                
                const startDecimal = startHour + (startMinute / 100);
                const endDecimal = endHour + (endMinute / 100);
                
                // Check operating hours (07:30-16:00)
                if (startDecimal < 7.5 || endDecimal > 16 || endDecimal <= startDecimal) {
                    this.showAlert('‚è∞ WAKTU INVALID', 'Booking hanya antara 07:30 - 16:00 WIB\nDurasi minimal 1 jam');
                    return false;
                }
                
                // Check duration (max 4 hours)
                const duration = (endDecimal - startDecimal) * 60;
                if (duration > 240) {
                    this.showAlert('‚è∞ DURASI TERLALU LAMA', 'Durasi maksimal booking adalah 4 jam');
                    return false;
                }
                
                return true;
            },

            showAlert: function(title, message) {
                document.getElementById('alertTitle').textContent = title;
                document.getElementById('alertMessage').textContent = message;
                document.getElementById('bookingAlert').style.display = 'block';
                
                setTimeout(() => {
                    document.getElementById('bookingAlert').style.display = 'none';
                }, 5000);
            },

            sendBooking: function() {
                const sarana = document.getElementById('bookingSarana').value;
                const pic = document.getElementById('bookingPIC').value;
                const unit = document.getElementById('bookingUnit').value;
                const date = document.getElementById('bookingDate').value;
                const startTime = document.getElementById('bookingStart').value;
                const endTime = document.getElementById('bookingEnd').value;
                
                // Validation
                if (!sarana || !pic || !unit || !date || !startTime || !endTime) {
                    this.showToast('‚ùå Isi semua data yang wajib!', true);
                    return;
                }
                
                // Check all rules
                if (!this.checkDateRules()) return;
                if (!this.checkTimeRules()) return;
                
                // Check Friday special rules
                const bookingDate = new Date(date);
                const day = bookingDate.getDay();
                const [startHour, startMinute] = startTime.split(':').map(Number);
                const startDecimal = startHour + (startMinute / 100);
                
                if (day === 5) { // Friday
                    const fridayLock = ['Aula SMP', 'Serbaguna'];
                    if (fridayLock.includes(sarana) && startDecimal >= 10.5 && startDecimal < 13) {
                        this.showToast('üïå Jumat: Aula SMP & Serba Guna locked 10:30-13:00', true);
                        return;
                    }
                }
                
                // Prepare WhatsApp message
                const message = `*BOOKING SARANA SIF - DREAM OS*\n\n` +
                               `üèõÔ∏è *Sarana:* ${sarana}\n` +
                               `üë§ *PIC:* ${pic}\n` +
                               `üë• *Unit:* ${unit}\n` +
                               `üìÖ *Tanggal:* ${date}\n` +
                               `‚è∞ *Waktu:* ${startTime} - ${endTime} WIB\n` +
                               `üìù *Keterangan:* ${document.getElementById('bookingNote').value || '-'}\n\n` +
                               `Status: *MENUNGGU KONFIRMASI*\n` +
                               `Via: Dream OS Ultimate v10.5\n\n` +
                               `_Email CC: teknisi@alfikri.sch.id_`;
                
                // Send to Pak Erwin
                window.open(`https://wa.me/628886183954?text=${encodeURIComponent(message)}`, '_blank');
                
                // Save locally
                this.saveBooking({
                    sarana, pic, unit, date, startTime, endTime,
                    note: document.getElementById('bookingNote').value,
                    timestamp: new Date().toISOString()
                });
                
                this.showToast('‚úÖ Booking berhasil dikirim ke Pak Erwin!');
                
                // Clear form and go back
                setTimeout(() => this.showView('service'), 1500);
            },

            saveBooking: function(data) {
                let bookings = JSON.parse(localStorage.getItem('sif_bookings') || '[]');
                bookings.unshift(data);
                localStorage.setItem('sif_bookings', JSON.stringify(bookings.slice(0, 50)));
            },

            checkAvailability: function() {
                const sarana = document.getElementById('bookingSarana').value;
                const date = document.getElementById('bookingDate').value;
                const startTime = document.getElementById('bookingStart').value;
                const endTime = document.getElementById('bookingEnd').value;
                
                if (!sarana || !date || !startTime || !endTime) {
                    this.showToast('‚ö†Ô∏è Isi data sarana, tanggal dan waktu terlebih dahulu');
                    return;
                }
                
                // Simulate availability check
                const available = Math.random() > 0.4;
                
                if (available) {
                    this.showToast(`‚úÖ ${sarana} tersedia untuk booking`);
                } else {
                    this.showToast(`‚ùå ${sarana} tidak tersedia - Sudah dibooking`, true);
                }
            },

            // ========== CAMERA SYSTEM ==========
            checkCameraSupport: function() {
                const hasCamera = 'mediaDevices' in navigator && 'getUserMedia' in navigator.mediaDevices;
                if (!hasCamera && this.currentMode !== this.SYSTEM_MODE.DEMO) {
                    this.showToast('‚ö†Ô∏è Device tidak support kamera - Mode manual aktif', true);
                    this.currentMode = this.SYSTEM_MODE.EMERGENCY;
                }
            },

            startCamera: function(type) {
                this.cameraType = type;
                const previewId = type + 'CameraPreview';
                const preview = document.getElementById(previewId);
                
                // Jika mode demo atau emergency, skip kamera
                if (this.currentMode === this.SYSTEM_MODE.DEMO || this.currentMode === this.SYSTEM_MODE.EMERGENCY) {
                    this.showToast('üì± MODE DEMO - Kamera dinonaktifkan');
                    this.showManualInput(type);
                    return;
                }

                // Low-end device optimization
                const isLowEnd = /Xiaomi|Redmi|Android 9|Android 10/i.test(navigator.userAgent);
                const constraints = {
                    video: {
                        facingMode: type === 'qr' ? 'environment' : 'user',
                        width: { ideal: isLowEnd ? 640 : 1280 },
                        height: { ideal: isLowEnd ? 480 : 720 },
                        frameRate: { ideal: isLowEnd ? 15 : 30 }
                    },
                    audio: false
                };

                navigator.mediaDevices.getUserMedia(constraints)
                    .then(stream => {
                        this.cameraStream = stream;
                        preview.srcObject = stream;
                        preview.play();
                        
                        // Show overlay for QR scanning
                        if (type === 'qr') {
                            document.getElementById('qrScanOverlay').style.display = 'block';
                            this.startQRScanning();
                        }
                        
                        this.showToast('üì∑ Kamera aktif - Siap digunakan');
                    })
                    .catch(err => {
                        console.error('Camera error:', err);
                        this.showToast('‚ùå Gagal akses kamera - Gunakan input manual', true);
                        this.showManualInput(type);
                        this.currentMode = this.SYSTEM_MODE.EMERGENCY;
                    });
            },

            capturePhoto: function(type) {
                if (!this.cameraStream) {
                    this.showToast('‚ùå Buka kamera terlebih dahulu', true);
                    return;
                }

                const previewId = type + 'CameraPreview';
                const preview = document.getElementById(previewId);
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                
                canvas.width = preview.videoWidth;
                canvas.height = preview.videoHeight;
                context.drawImage(preview, 0, 0, canvas.width, canvas.height);
                
                // Add watermark
                context.font = "16px Arial";
                context.fillStyle = "#fbbf24";
                context.fillText("DREAM OS - " + new Date().toLocaleString(), 20, canvas.height - 20);
                
                this.lastPhoto = canvas.toDataURL('image/jpeg', 0.8);
                
                // Show preview
                const photoId = type + 'Photo';
                const photoPreviewId = type + 'PhotoPreview';
                
                document.getElementById(photoId).src = this.lastPhoto;
                document.getElementById(photoPreviewId).style.display = 'block';
                
                this.showToast('‚úÖ Foto berhasil diambil!');
                this.stopCamera(type);
            },

            stopCamera: function(type) {
                if (this.cameraStream) {
                    this.cameraStream.getTracks().forEach(track => track.stop());
                    this.cameraStream = null;
                }
                
                const previewId = type + 'CameraPreview';
                const preview = document.getElementById(previewId);
                if (preview) {
                    preview.srcObject = null;
                }
                
                // Hide overlay
                if (type === 'qr') {
                    document.getElementById('qrScanOverlay').style.display = 'none';
                    this.stopQRScanner();
                }
            },

            stopAllCameras: function() {
                this.stopCamera('k3');
                this.stopCamera('security');
                this.stopCamera('qr');
            },

            showManualInput: function(type) {
                document.getElementById(type + 'ManualInput').style.display = 'block';
            },

            useManualInput: function(type) {
                const input = document.getElementById(type + 'ManualInputField').value;
                if (!input) {
                    this.showToast('‚ùå Isi input manual terlebih dahulu', true);
                    return;
                }
                
                this.lastPhoto = null;
                this.showToast('‚úÖ Input manual digunakan');
                document.getElementById(type + 'ManualInput').style.display = 'none';
            },

            // ========== K3 SYSTEM ==========
            sendK3: function() {
                const location = document.getElementById('k3Location').value;
                const type = document.getElementById('k3Type').value;
                const description = document.getElementById('k3Description').value;
                
                if (!location || !type || !description) {
                    this.showToast('‚ùå Isi semua data laporan K3!', true);
                    return;
                }
                
                // Prepare email
                const emailBody = `Subject: LAPORAN K3 - SIF AL FIKRI\n\n` +
                                 `LOKASI: ${location}\n` +
                                 `JENIS: ${type}\n` +
                                 `DESKRIPSI: ${description}\n\n` +
                                 `BUKTI FOTO: ${this.lastPhoto ? 'Tersimpan di database' : 'Tidak ada foto'}\n` +
                                 `Dilaporkan via: DREAM OS Quantum Camera\n` +
                                 `Waktu: ${new Date().toLocaleString()}`;
                
                // Send to teknisi
                window.open(`mailto:teknisi@alfikri.sch.id?body=${encodeURIComponent(emailBody)}`, '_blank');
                
                // Save report
                const k3Report = {
                    id: Date.now(),
                    location, type, description,
                    photo: this.lastPhoto ? 'yes' : 'no',
                    timestamp: new Date().toISOString(),
                    status: 'pending'
                };
                
                let reports = JSON.parse(localStorage.getItem('sif_k3_reports') || '[]');
                reports.unshift(k3Report);
                localStorage.setItem('sif_k3_reports', JSON.stringify(reports));
                
                this.showToast('‚úÖ Laporan K3 dikirim ke teknisi!');
                this.lastPhoto = null;
                document.getElementById('k3PhotoPreview').style.display = 'none';
                
                setTimeout(() => this.showView('service'), 1000);
            },

            // ========== SECURITY SYSTEM ==========
            sendSecurityReport: function() {
                const name = document.getElementById('securityName').value;
                const type = document.getElementById('securityType').value;
                const location = document.getElementById('securityLocation').value;
                const description = document.getElementById('securityDescription').value;
                
                if (!name || !type || !location || !description) {
                    this.showToast('‚ùå Isi semua data laporan sekuriti!', true);
                    return;
                }
                
                // Prepare report
                const report = {
                    id: Date.now(),
                    name, type, location, description,
                    photo: this.lastPhoto ? 'yes' : 'no',
                    timestamp: new Date().toISOString(),
                    status: 'submitted'
                };
                
                // Save report
                let reports = JSON.parse(localStorage.getItem('sif_security_reports') || '[]');
                reports.unshift(report);
                localStorage.setItem('sif_security_reports', JSON.stringify(reports));
                
                this.showToast('‚úÖ Laporan sekuriti berhasil disimpan!');
                this.lastPhoto = null;
                document.getElementById('securityPhotoPreview').style.display = 'none';
                
                setTimeout(() => this.showView('service'), 1000);
            },

            // ========== QR SCANNER SYSTEM ==========
            startQRScanner: function() {
                this.startCamera('qr');
            },

            stopQRScanner: function() {
                this.stopCamera('qr');
                this.isScanning = false;
            },

            startQRScanning: function() {
                if (!this.isScanning) {
                    this.isScanning = true;
                    this.scanQRCode();
                }
            },

            scanQRCode: function() {
                if (!this.isScanning) return;
                
                const preview = document.getElementById('qrCameraPreview');
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                
                canvas.width = preview.videoWidth;
                canvas.height = preview.videoHeight;
                context.drawImage(preview, 0, 0, canvas.width, canvas.height);
                
                // In real implementation, use jsQR library here
                // For demo, simulate QR detection
                setTimeout(() => {
                    if (this.isScanning && Math.random() > 0.7) {
                        this.processQRResult('INV-001:Proyektor Epson EB-X41');
                    }
                    
                    if (this.isScanning) {
                        requestAnimationFrame(() => this.scanQRCode());
                    }
                }, 100);
            },

            processQRResult: function(code) {
                this.stopQRScanner();
                this.showToast('üéâ QR Code berhasil discan!');
                
                document.getElementById('qrResultText').textContent = code;
                document.getElementById('qrResultDetails').textContent = 
                    'Item ditemukan di database inventory';
                document.getElementById('qrResult').style.display = 'block';
            },

            simulateQRScan: function() {
                // Demo mode for RAKER
                const demoCodes = [
                    'INV-001: Proyektor Epson EB-X41 - Gudang B',
                    'INV-005: Meja Panjang Kayu Jati - Warehouse',
                    'ASSET-012: Kabel HDMI 10m - Gudang C',
                    'BOOKING-2024-001: Aula SMP - 14:00-16:00'
                ];
                
                const randomCode = demoCodes[Math.floor(Math.random() * demoCodes.length)];
                this.processQRResult(randomCode);
                this.showToast('‚ú® DEMO MODE: QR Scan berhasil!');
            },

            processManualQR: function() {
                const code = document.getElementById('qrManualInputField').value.trim();
                if (!code) {
                    this.showToast('‚ùå Masukkan kode QR terlebih dahulu', true);
                    return;
                }
                
                this.processQRResult(code);
                document.getElementById('qrManualInputField').value = '';
            },

            // ========== VAULT SYSTEM ==========
            openVault: function(type) {
                this.vaultType = type;
                const modal = document.getElementById('vaultModal');
                const title = document.getElementById('vaultTitle');
                const subtitle = document.getElementById('vaultSubtitle');
                
                if (type === 'inventory') {
                    title.textContent = 'INVENTORY VAULT';
                    subtitle.textContent = 'Password: 4dm1in_6969@01';
                } else {
                    title.textContent = 'WAREHOUSE VAULT';
                    subtitle.textContent = 'Password: 4dm1n_9696@02';
                }
                
                modal.style.display = 'block';
                document.getElementById('vaultPassword').value = '';
                document.getElementById('vaultPassword').focus();
            },

            accessVault: function() {
                const password = document.getElementById('vaultPassword').value;
                const vaultPasswords = {
                    'inventory': '4dm1in_6969@01',
                    'warehouse': '4dm1n_9696@02'
                };
                
                if (password === vaultPasswords[this.vaultType]) {
                    this.closeModal('vaultModal');
                    
                    if (this.vaultType === 'inventory') {
                        this.showView('inventory');
                        this.showToast('üîì Inventory vault unlocked');
                    } else {
                        this.showView('warehouse');
                        this.showToast('üîì Warehouse vault unlocked');
                    }
                } else {
                    this.showToast('‚ùå Wrong vault password!', true);
                }
            },

            // ========== UTILITIES ==========
            showToast: function(message, isError = false) {
                const toast = document.getElementById('toast');
                toast.textContent = message;
                toast.className = isError ? 'toast toast-error' : 'toast';
                toast.style.display = 'block';
                
                setTimeout(() => {
                    toast.style.display = 'none';
                }, 3000);
            },

            updateClock: function() {
                const now = new Date();
                const time = now.toLocaleTimeString('id-ID');
                document.getElementById('clock').textContent = 'üïê ' + time;
            },

            // ========== AI FUNCTIONS ==========
            aiDiagnostic: function() {
                const issues = [
                    '‚úÖ System: Normal',
                    '‚úÖ Database: Connected',
                    '‚úÖ Security: Active',
                    '‚úÖ Performance: Optimal',
                    'ü§ñ AI: QuantumAI, DeepSeek, Qwen Active',
                    'üì∑ Camera: ' + (this.currentMode === this.SYSTEM_MODE.DEMO ? 'Demo Mode' : 'Ready'),
                    'üîí Mode: ' + this.currentMode.toUpperCase()
                ];
                
                alert('ü§ñ AI DIAGNOSTIC REPORT:\n\n' + issues.join('\n'));
            },

            systemReboot: function() {
                if (confirm('Reboot system? All temporary data will be cleared.')) {
                    localStorage.clear();
                    location.reload();
                }
            },

            // ========== LIVE DEMO ==========
            startLiveDemo: function() {
                this.currentMode = this.SYSTEM_MODE.DEMO;
                const steps = [
                    { delay: 0, action: () => this.showToast('üöÄ LIVE DEMO DIMULAI!') },
                    { delay: 1000, action: () => this.showView('service') },
                    { delay: 2000, action: () => this.showView('booking') },
                    { delay: 3000, action: () => {
                        document.getElementById('bookingSarana').value = 'Aula SMP';
                        document.getElementById('bookingPIC').value = 'Guru Demo';
                        document.getElementById('bookingUnit').value = 'SMA';
                        const nextFriday = this.getNextFriday();
                        document.getElementById('bookingDate').value = nextFriday;
                        document.getElementById('bookingStart').value = '11:00';
                        document.getElementById('bookingEnd').value = '13:00';
                        this.showToast('üìÖ Demo: Booking Aula SMP Jumat 11:00-13:00');
                    }},
                    { delay: 5000, action: () => {
                        this.showToast('‚ùå Auto-reject: Jumat 10:30-13:00 Aula SMP locked');
                        setTimeout(() => {
                            this.showToast('üîÑ Ganti ke jam 13:30-15:30');
                            document.getElementById('bookingStart').value = '13:30';
                            document.getElementById('bookingEnd').value = '15:30';
                        }, 1500);
                    }},
                    { delay: 8000, action: () => {
                        this.showToast('‚úÖ Sekarang booking diterima!');
                    }},
                    { delay: 10000, action: () => {
                        this.showView('k3');
                        this.showToast('üéØ Demo K3 dengan kamera');
                    }},
                    { delay: 12000, action: () => {
                        this.showView('qrscanner');
                        this.showToast('üì∑ Demo QR Scanner');
                        setTimeout(() => this.simulateQRScan(), 1000);
                    }}
                ];
                
                steps.forEach(step => setTimeout(step.action, step.delay));
            },

            getNextFriday: function() {
                const today = new Date();
                const day = today.getDay();
                const daysUntilFriday = day <= 5 ? 5 - day : 5 + (7 - day);
                const nextFriday = new Date(today);
                nextFriday.setDate(today.getDate() + daysUntilFriday);
                return nextFriday.toISOString().split('T')[0];
            }
        };

        // =========================================
        // INITIALIZE SYSTEM
        // =========================================
        window.onload = function() {
            system.init();
            
            console.log('üî• Dream OS Ultimate v10.5 - Complete System!');
        };
    </script>
</body>
</html>
